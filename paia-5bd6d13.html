<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Jakob Voß" />
  <meta name="date" content="2023-08-24" />
  <title>Patrons Account Information API (PAIA)</title>
   <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <style type="text/css">
/*<![CDATA[*/
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
/*]]>*/
  </style>
  <style type="text/css">
  body { font-family: sans-serif; }
  a { text-decoration: none }
  a:hover { text-decoration: underline }
  h1 { font: 170% sans-serif }
  h1.title { font-size: 200%; font-weight: bold; }
  h2 { font: 140% sans-serif }
  h3 { font: 120% sans-serif }
  dt { font-weight: bold; }
  h1, h2, h3, h1 a, h2 a, h3 a { color: #005A9C; }
  table { border-collapse: collapse; }
  td { border: 1px solid #999; padding: 3px }
  dl p { margin-top: 0; }
  dt { margin-top: 0.8em; }
  dd { margin-left: 1.5em; }
  ol { margin-bottom: 1em; }
  table + p { margin-top: 1em; }
  </style>
  <link rel="stylesheet" href="/home/voj/proj/paia/makespec/templates/default.css" />
  <link rel="stylesheet" href="makespec.css" />
</head>
<body>
<a href="http://github.com/gbv/paia/"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png" alt="Fork me on GitHub"></a>
<header>
<h1 class="title">Patrons Account Information API (PAIA)</h1>
<h3 class="author">Jakob Voß</h3>
<h4 class="date">2023-08-24 (version 1.4.0)</h4>
</header>

<h1>Table of Contents</h1>
<nav id="TOC">
<ul>
<li><a href="#introduction"><span class="toc-section-number">1</span> Introduction</a><ul>
<li><a href="#synopsis"><span class="toc-section-number">1.1</span> Synopsis</a></li>
<li><a href="#status-of-this-document"><span class="toc-section-number">1.2</span> Status of this document</a></li>
<li><a href="#conformance-requirements"><span class="toc-section-number">1.3</span> Conformance requirements</a></li>
</ul></li>
<li><a href="#basics"><span class="toc-section-number">2</span> Basics</a><ul>
<li><a href="#api-methods"><span class="toc-section-number">2.1</span> API methods</a></li>
<li><a href="#access-tokens-and-scopes"><span class="toc-section-number">2.2</span> Access tokens and scopes</a></li>
<li><a href="#request-and-response-format"><span class="toc-section-number">2.3</span> Request and response format</a></li>
<li><a href="#url-query-fields"><span class="toc-section-number">2.4</span> URL query fields</a></li>
<li><a href="#http-headers"><span class="toc-section-number">2.5</span> HTTP headers</a></li>
<li><a href="#http-message-body"><span class="toc-section-number">2.6</span> HTTP message body</a></li>
<li><a href="#request-errors"><span class="toc-section-number">2.7</span> Request errors</a></li>
<li><a href="#simple-data-types"><span class="toc-section-number">2.8</span> Simple data types</a></li>
<li><a href="#documents"><span class="toc-section-number">2.9</span> Documents</a></li>
<li><a href="#patron-notification"><span class="toc-section-number">2.10</span> Notifications</a></li>
<li><a href="#conditions-and-confirmations"><span class="toc-section-number">2.11</span> Conditions and confirmations</a></li>
</ul></li>
<li><a href="#paia-core"><span class="toc-section-number">3</span> PAIA core</a><ul>
<li><a href="#patron"><span class="toc-section-number">3.1</span> patron</a></li>
<li><a href="#update-patron"><span class="toc-section-number">3.2</span> update patron</a></li>
<li><a href="#items"><span class="toc-section-number">3.3</span> items</a></li>
<li><a href="#request"><span class="toc-section-number">3.4</span> request</a></li>
<li><a href="#renew"><span class="toc-section-number">3.5</span> renew</a></li>
<li><a href="#cancel"><span class="toc-section-number">3.6</span> cancel</a></li>
<li><a href="#fees"><span class="toc-section-number">3.7</span> fees</a></li>
<li><a href="#notifications"><span class="toc-section-number">3.8</span> notifications</a></li>
</ul></li>
<li><a href="#paia-auth"><span class="toc-section-number">4</span> PAIA auth</a><ul>
<li><a href="#login"><span class="toc-section-number">4.1</span> login</a></li>
<li><a href="#logout"><span class="toc-section-number">4.2</span> logout</a></li>
<li><a href="#change"><span class="toc-section-number">4.3</span> change</a></li>
<li><a href="#reset"><span class="toc-section-number">4.4</span> reset</a></li>
</ul></li>
<li><a href="#glossary"><span class="toc-section-number">5</span> Glossary</a></li>
<li><a href="#security-considerations"><span class="toc-section-number">6</span> Security considerations</a></li>
<li><a href="#informative-parts"><span class="toc-section-number">7</span> Informative parts</a><ul>
<li><a href="#transitions-of-service-states"><span class="toc-section-number">7.1</span> Transitions of service states</a></li>
<li><a href="#digital-documents"><span class="toc-section-number">7.2</span> Digital documents</a></li>
<li><a href="#paia-core-extensions-to-non-document-services"><span class="toc-section-number">7.3</span> PAIA core extensions to non-document services</a></li>
</ul></li>
<li><a href="#references"><span class="toc-section-number">8</span> References</a><ul>
<li><a href="#normative-references"><span class="toc-section-number">8.1</span> Normative References</a></li>
<li><a href="#informative-references"><span class="toc-section-number">8.2</span> Informative References</a></li>
<li><a href="#revision-history"><span class="toc-section-number">8.3</span> Revision history</a></li>
</ul></li>
</ul>
</nav>
<section id="introduction" class="level1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<p>The <strong>Patrons Account Information API (PAIA)</strong> is a HTTP based programming interface to access library patron information, such as loans, reservations, fees, and messages. Its primary goal is to provide patron access for discovery interfaces and other third-party applications to integrated library system, as easy and open as possible.</p>
<section id="synopsis" class="level2">
<h2><span class="header-section-number">1.1</span> Synopsis</h2>
<p>PAIA consists of two independent parts:</p>
<ul>
<li><p><strong><a href="#paia-core">PAIA core</a></strong> defines six basic <a href="#api-methods">API methods</a> to look up loaned and reserved <a href="#items">items</a>, to <a href="#request">request</a> and <a href="#cancel">cancel</a> loans and reservations, and to look up <a href="#fees">fees</a>, <a href="#notifications">notifications</a>, and general <a href="#patron">patron</a> information.</p></li>
<li><p><strong><a href="#paia-auth">PAIA auth</a></strong> defines three authentication <a href="#api-methods">API methods</a> (<a href="#login">login</a>, <a href="#logout">logout</a>, <a href="#change">change</a> and <a href="#reset">reset</a>) to get or invalidate and <a href="#access-tokens-and-scopes">access token</a>, and to modify/reset credentials.</p></li>
</ul>
<p>Authentication in PAIA is based on <strong>OAuth 2.0</strong> (<a href="http://tools.ietf.org/html/rfc6749">RFC 6749</a>) with bearer tokens (<a href="http://tools.ietf.org/html/rfc6750">RFC 6750</a>) over HTTPS (<a href="http://tools.ietf.org/html/rfc2818">RFC 2818</a>).</p>
</section>
<section id="status-of-this-document" class="level2">
<h2><span class="header-section-number">1.2</span> Status of this document</h2>
<p>This specification has been created collaboratively based on use cases and taking into account existing related standards and products of integrated library systems (ILS), such as NISO Circulation Interchange Protocol (NCIP), SIP2, [X]SLNP,<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a> DLF-ILS recommendations, and VuFind ILS.</p>
<p>All sources and updates can be found in a public git repository at <a href="http://github.com/gbv/paia" class="uri">http://github.com/gbv/paia</a>. See the <a href="#releases">list of releases</a> at <a href="https://github.com/gbv/paia/releases" class="uri">https://github.com/gbv/paia/releases</a> for functional changes. The master file <a href="https://github.com/gbv/paia/blob/master/paia.md">paia.md</a> is written in <a href="http://johnmacfarlane.net/pandoc/demo/example9/pandocs-markdown.html">Pandoc’s Markdown</a>. HTML version of the specification is generated from the master file with <a href="https://github.com/jakobib/makespec">makespec</a>. The specification can be distributed freely under the terms of CC-BY-SA.</p>
<p>Additional information and references about PAIA can be found in the public PAIA Wiki at <a href="https://github.com/gbv/paia/wiki" class="uri">https://github.com/gbv/paia/wiki</a>.</p>
</section>
<section id="conformance-requirements" class="level2">
<h2><span class="header-section-number">1.3</span> Conformance requirements</h2>
<p>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL” in this document are to be interpreted as described in <a href="http://tools.ietf.org/html/rfc2119">RFC 2119</a>.</p>
<p>A PAIA server MUST implement <a href="#paia-core">PAIA core</a> and it MAY implement <a href="#paia-auth">PAIA auth</a>. If PAIA auth is not implemented, another way SHOULD BE documented to distribute patron identifiers and access tokens. A PAIA server MAY support only a subset of methods but it MUST return a valid response or an <a href="#request-errors">error response</a> on every method request, as defined in this document.</p>
</section>
</section>
<section id="basics" class="level1">
<h1><span class="header-section-number">2</span> Basics</h1>
<section id="api-methods" class="level2">
<h2><span class="header-section-number">2.1</span> API methods</h2>
<p>Each API method is accessed at a unique URL with a HTTP verb GET, POST, or PATCH:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;"><a href="#paia-core">PAIA core</a></th>
<th style="text-align: left;"><a href="#paia-auth">PAIA auth</a></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><a href="#patron">GET</a>/<a href="#update-patron">PATCH</a> patron: general patron information</td>
<td style="text-align: left;">POST <a href="#login">login</a>: get access token</td>
</tr>
<tr class="even">
<td style="text-align: left;">GET <a href="#items">items</a>: current loans, reservations, …</td>
<td style="text-align: left;">POST <a href="#logout">logout</a>: invalidate access token</td>
</tr>
<tr class="odd">
<td style="text-align: left;">POST <a href="#request">request</a>: new reservation, delivery, …</td>
<td style="text-align: left;">POST <a href="#change">change</a>: modify credentials</td>
</tr>
<tr class="even">
<td style="text-align: left;">POST <a href="#renew">renew</a>: existing loans, reservations, …</td>
<td style="text-align: left;">POST <a href="#reset">reset</a>: reset credentials</td>
</tr>
<tr class="odd">
<td style="text-align: left;">POST <a href="#cancel">cancel</a>: requests, reservations, …</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">GET <a href="#fees">fees</a>: paid and open charges</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">GET/DELETE <a href="#notifications">notifications</a>: patron notifications</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<p>All supported API method URLs MUST also be accessible with HTTP verb OPTIONS. Unsupported API methods MUST result in a <a href="#request-errors">request error</a> with error code 501. All API methods with HTTP verb GET MAY also be accessible with HTTP verb HEAD.</p>
<p>API method URLs share a common base URL for PAIA core methods and common base URL for PAIA auth methods. A server SHOULD NOT provide additional methods at these base URLs and it MUST NOT propagate additional methods at these base URLs as belonging to PAIA.</p>
<p>Base URLs of PAIA auth and PAIA core are not required to share a common host, nor to include the URL path <code>core/</code> or <code>auth/</code>. In the following, the base URL <a href="https://example.org/core/" class="uri">https://example.org/core/</a> is used for PAIA core and <a href="https://example.org/auth/" class="uri">https://example.org/auth/</a> for PAIA auth.</p>
<p>For security reasons, PAIA methods MUST be requested via HTTPS only. A PAIA client MUST NOT ignore SSL certificate errors; otherwise access token (PAIA core) or even password (PAIA auth) are compromised by the client.</p>
</section>
<section id="access-tokens-and-scopes" class="level2">
<h2><span class="header-section-number">2.2</span> Access tokens and scopes</h2>
<p>All PAIA API methods, except PAI auth <a href="#login">login</a> and HTTP OPTIONS requests require an <strong>access token</strong> as a special request parameter. The access token is a so called bearer token as described in <a href="http://tools.ietf.org/html/rfc6750">RFC 6750</a>. The access token can be sent either as a URL query parameter or in an HTTP header. For instance the following requests both get information about patron <code>123</code> with access token <code>vF9dft4qmT</code>:</p>
<pre><code>curl -H &quot;Authorization: Bearer vF9dft4qmT&quot; https://example.org/core/123
curl -H https://example.org/core/123?access_token=vF9dft4qmT</code></pre>
<p>An access token is valid for a limited set of actions, referred to as <strong>scope</strong>. The following scopes are possible for PAIA core:</p>
<dl>
<dt>read_patron</dt>
<dd>Get patron information by the <a href="#patron">patron</a> method.
</dd>
<dt>update_patron / update_patron_name / update_patron_email / update_patron_address</dt>
<dd>Update parts of the patron information by the <a href="#update-patron">update patron</a> method.
</dd>
<dt>read_items</dt>
<dd>Get a patron’s item information by the <a href="#items">items</a> method.
</dd>
<dt>write_items</dt>
<dd>Request, renew, and cancel items by the <a href="#request">request</a>, <a href="#renew">renew</a>, and <a href="#cancel">cancel</a> methods.
</dd>
<dt>read_fees</dt>
<dd>Get fees of a patron by the <a href="#fees">fees</a> method.
</dd>
<dt>read_notifications</dt>
<dd>Get notifications to a patron by the <a href="#notifications">notifications</a> method.
</dd>
<dt>delete_notifications</dt>
<dd>Delete notifications to a patron listed by the <a href="#notifications">notifications</a> method.
</dd>
</dl>
<p>For instance a particular token with scopes <code>read_patron</code> and <code>read_items</code> may be used for read-only access to information about a patron, including its loans and requested items but not its fees.</p>
<p>For PAIA auth there is an additional scope:</p>
<dl>
<dt>change_password</dt>
<dd>Change the password of a patron with the PAIA auth <a href="#change">change</a> method.
</dd>
<dt>reset_password</dt>
<dd>Reset the password of a patron with the PAIA auth <a href="#reset">reset</a> method.
</dd>
</dl>
<p>A PAIA auth server MAY support additional scopes to share an access token with other services.</p>
</section>
<section id="request-and-response-format" class="level2">
<h2><span class="header-section-number">2.3</span> Request and response format</h2>
<p>Each API method call expects a set of request parameters, given as <a href="#url-query-fields">URL query fields</a>, <a href="#http-headers">HTTP headers</a>, or <a href="#http-message-body">HTTP message body</a> and returns a JSON object or empty response body. Most parts of PAIA core request parameters and JSON response can be mapped to RDF as defined by the <a href="http://gbv.github.io/paia-rdf/">PAIA Ontology</a>.</p>
<p>Request parameters and fields of response objects are defined in this document with:</p>
<ul>
<li>the <strong>name</strong> of the parameter/field</li>
<li>the <strong>ocurrence</strong> (occ) of the parameter/field being one of
<ul>
<li><code>0..1</code> (optional, non repeatable)</li>
<li><code>1..1</code> (mandatory, non repeatable)</li>
<li><code>1..n</code> (mandatory, repeatable)</li>
<li><code>0..n</code> (optional, repeatable)</li>
</ul></li>
<li>the <strong>data type</strong> of the parameter/field</li>
<li>a short description</li>
</ul>
<p>Simple parameter names and response fields consist of lowercase letters <code>a-z</code> only.</p>
<p>Repeatable response fields are encoded as JSON arrays with irrelevant order, for instance:</p>
<div class="sourceCode"><pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span> <span class="dt">&quot;fee&quot;</span> <span class="fu">:</span> <span class="ot">[</span> <span class="fu">{</span> <span class="er">...</span> <span class="fu">}</span><span class="ot">,</span> <span class="fu">{</span> <span class="er">...</span> <span class="fu">}</span> <span class="ot">]</span> <span class="fu">}</span></code></pre></div>
<p>Hierarchical JSON structures in this document are referenced with a dot (<code>.</code>) as separator. For instance the subfield/parameter <code>item</code> of the <code>doc</code> element is referenced as <code>doc.item</code> and refers to the following JSON structure:</p>
<div class="sourceCode"><pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span> <span class="dt">&quot;doc&quot;</span> <span class="fu">:</span> <span class="ot">[</span> <span class="fu">{</span> <span class="dt">&quot;item&quot;</span> <span class="fu">:</span> <span class="st">&quot;...&quot;</span> <span class="fu">}</span> <span class="ot">]</span> <span class="fu">}</span></code></pre></div>
</section>
<section id="url-query-fields" class="level2">
<h2><span class="header-section-number">2.4</span> URL query fields</h2>
<p>The following special request parameters can be added to any request as URL query fields:</p>
<dl>
<dt>access_token</dt>
<dd>An <a href="#access-tokens-and-scopes">access token</a> can be sent either as URL query parameter or as HTTP request header.
</dd>
<dt>callback</dt>
<dd>A JavaScript callback method name to return JSONP instead of JSON. The callback MUST only contain alphanumeric characters and underscores.
</dd>
<dt>suppress_response_codes</dt>
<dd>If this parameter is present, <em>all</em> responses MUST be returned with a 200 OK status code, even <a href="#request-errors">request errors</a>.
</dd>
</dl>
</section>
<section id="http-headers" class="level2">
<h2><span class="header-section-number">2.5</span> HTTP headers</h2>
<section id="request-headers" class="level3 unnumbered">
<h3>Request headers</h3>
<p>The following HTTP request headers SHOULD or MAY be sent by PAIA clients in particular:</p>
<dl>
<dt>User-Agent</dt>
<dd>SHOULD be sent with an appropriate client name and version number
</dd>
<dt>Accept</dt>
<dd>SHOULD be sent with value <code>application/json</code>
</dd>
<dt>Authorization</dt>
<dd>MAY be sent to provide an <a href="#access-tokens-and-scopes">access token</a> or client credentials (<a href="#login">login</a>)
</dd>
<dt>Accept-Language</dt>
<dd>MAY be sent to indicate preferred languages of textual response fields
</dd>
<dt>Content-Type</dt>
<dd>SHOULD be sent for HTTP POST with value <code>application/json</code> or for PAIA core and <code>application/x-www-form-urlencoded</code> for PAIA auth.
</dd>
</dl>
<p>A OPTIONS preflight request for Cross-Origin Resource Sharing (CORS) MUST include the cross-origin request headers:</p>
<dl>
<dt>Origin</dt>
<dd>Where the cross-origin request originates from
</dd>
<dt>Access-Control-Request-Method</dt>
<dd>The HTTP verb of the actual request (GET or POST)
</dd>
<dt>Access-Control-Request-Headers</dt>
<dd>The value <code>Authorization</code> if access tokens are sent as HTTP headers
</dd>
</dl>
<p>Note that PAIA specification does not require clients to respect CORS rules. CORS preflight requests in browsers can be avoided by using request format <code>application/x-www-form-urlencoded</code> and omitting the request headers <code>Accept</code> and <code>Authorization</code>.</p>
</section>
<section id="response-headers" class="level3 unnumbered">
<h3>Response headers</h3>
<p>PAIA core and PAIA auth servers SHOULD include the following HTTP response headers:</p>
<dl>
<dt>Content-Language</dt>
<dd>The language of textual response fields
</dd>
<dt>X-OAuth-Scopes</dt>
<dd>A space-separated list of <a href="#access-token-and-scopes">scopes</a>, the current token has authorized, not limited to PAIA scopes. The scopes <code>change_password</code> and <code>reset_password</code> MAY be omitted in PAIA core responses.
</dd>
<dt>X-Accepted-OAuth-Scopes</dt>
<dd>A space-separated list of <a href="#access-token-and-scopes">scopes</a>, the current method checks for
</dd>
<dt>Access-Control-Expose-Headers</dt>
<dd>The value <code>X-OAuth-Scopes X-Accepted-OAuth-Scopes</code>
</dd>
<dt>Access-Control-Allow-Origin</dt>
<dd>The value <code>*</code> or another origin domain in response to a <code>Origin</code> request header.
</dd>
<dt>WWW-Authenticate</dt>
<dd>The value <code>Bearer</code> for <a href="#request-errors">request errors</a> with status 401
</dd>
<dt>Allow</dt>
<dd>A list of supported HTTP verbs (e.g. <code>GET, HEAD, OPTIONS</code>) for <a href="#request-errors">request errors</a> with status 405
</dd>
</dl>
<p>PAIA core and PAIA auth servers MUST include the following HTTP response headers:</p>
<dl>
<dt>Content-Type</dt>
<dd>The value <code>application/json</code> or <code>application/json; charset=utf-8</code> for JSON response; the value <code>application/javascript</code> or <code>application/javascript; charset=utf-8</code> for JSONP response
</dd>
<dt>X-PAIA-Version</dt>
<dd>The version of PAIA specification which the server was checked against.
</dd>
<dt>Access-Control-Allow-Headers</dt>
<dd>In response to a HTTP OPTIONS request this header MUST included the values <code>Content-Type</code>, <code>Authorization</code>, and <code>Accept-Language</code>
</dd>
</dl>
</section>
</section>
<section id="http-message-body" class="level2">
<h2><span class="header-section-number">2.6</span> HTTP message body</h2>
<p>All POST and PATCH requests MUST include a HTTP message body.</p>
<ul>
<li><p>For <a href="#paia-core">PAIA core</a> the message body MUST be sent in JSON format with content type <code>application/json</code>. A PAIA core server MAY also support message body as URL encoded query string.</p></li>
<li><p>For <a href="#paia-auth">PAIA auth</a> the message body MUST be sent as URL encoded query string with content type <code>application/x-www-form-urlencoded</code>. A PAIA auth server MAY also support message body in JSON.</p></li>
</ul>
<p>A PAIA Server MUST also accept the explicit charset UTF8 (content type <code>application/json; charset=utf-8</code> or <code>application/x-www-form-urlencoded; charset=utf-8</code>). A PAIA Server MAY support additional request charsets such as ISO-8859-1.</p>
</section>
<section id="request-errors" class="level2">
<h2><span class="header-section-number">2.7</span> Request errors</h2>
<p>Malformed requests, failed authentication, unsupported methods, and unexpected server errors such as backend downtime etc. MUST result in an error response. An error response is returned with an HTTP status code 4xx (client error) or 5xx (server error) as defined in <a href="http://tools.ietf.org/html/rfc2616">RFC 2616</a>, unless the request parameter <code>suppress_response_codes</code> is given.</p>
<p><a href="#documents">Document errors</a> MUST NOT result in a request error but they are part of a normal response.</p>
<p>The response body of a request error is a JSON object with the following fields (compatible with OAuth error response):</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">name</th>
<th style="text-align: center;">occ</th>
<th style="text-align: center;">data type</th>
<th style="text-align: center;">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>error</td>
<td>1..1</td>
<td>string</td>
<td>alphanumerical error code</td>
</tr>
<tr class="even">
<td>code</td>
<td>0..1</td>
<td>nonnegative integer</td>
<td>HTTP status error code</td>
</tr>
<tr class="odd">
<td>error_description</td>
<td>0..1</td>
<td>string</td>
<td>Human-readable error description</td>
</tr>
<tr class="even">
<td>error_uri</td>
<td>0..1</td>
<td>string</td>
<td>Human-readable web page about the error</td>
</tr>
</tbody>
</table>
<p>The <code>code</code> field is REQUIRED with request parameter <code>suppress_response_codes</code> in PAIA core. It SHOULD be omitted with PAIA auth requests to not confuse OAuth clients.</p>
<p>The response header of a request error MUST include a <code>WWW-Authenticate</code> header field to indicate the need of providing a proper access token. The field MAY include a short name of the PAIA server with a “realm” parameter:</p>
<pre><code>WWW-Authenticate: Bearer
WWW-Authenticate: Bearer realm=&quot;PAIA Core&quot;</code></pre>
<p>The following error responses are expected:<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a></p>
<table>
<colgroup>
<col style="width: 21%" />
<col style="width: 6%" />
<col style="width: 71%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">error</th>
<th style="text-align: center;">code</th>
<th style="text-align: center;">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>not_found</td>
<td>404</td>
<td>Unknown request URL or unknown patron. Implementations SHOULD first check authentication and prefer error <code>invalid_grant</code> or <code>access_denied</code> to prevent leaking patron identifiers.</td>
</tr>
<tr class="even">
<td>not_implemented</td>
<td>501</td>
<td>Known but unsupported request URL (for instance a PAIA auth server server that does not implement <code>http://example.org/core/change</code>)</td>
</tr>
<tr class="odd">
<td>invalid_request</td>
<td>405</td>
<td>Unexpected HTTP verb</td>
</tr>
<tr class="even">
<td>invalid_request</td>
<td>400</td>
<td>Malformed request (for instance error parsing JSON, unsupported request content type, etc.)</td>
</tr>
<tr class="odd">
<td>invalid_request</td>
<td>422</td>
<td>The request parameters could be parsed but they don’t match the request method (for instance missing fields, invalid values, etc.)</td>
</tr>
<tr class="even">
<td>invalid_grant</td>
<td>401</td>
<td>The access token was missing, invalid, or expired</td>
</tr>
<tr class="odd">
<td>insufficient_scope</td>
<td>403</td>
<td>The access token was accepted but it lacks permission for the request</td>
</tr>
<tr class="even">
<td>access_denied</td>
<td>403</td>
<td>Wrong or missing credentials to get an access token</td>
</tr>
<tr class="odd">
<td>internal_error</td>
<td>500</td>
<td>An unexpected error occurred. This error corresponds to a bug in the implementation of a PAIA auth/core server</td>
</tr>
<tr class="even">
<td>service_unavailable</td>
<td>503</td>
<td>The request couldn’t be serviced because of a temporary failure</td>
</tr>
<tr class="odd">
<td>bad_gateway</td>
<td>502</td>
<td>The request couldn’t be serviced because of a backend failure (for instance the library system’s database)</td>
</tr>
<tr class="even">
<td>gateway_timeout</td>
<td>504</td>
<td>The request couldn’t be serviced because of a backend failure</td>
</tr>
</tbody>
</table>
<p>For instance the following response could result from a request with malformed URIs:</p>
<div class="sourceCode"><pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
  <span class="dt">&quot;error&quot;</span><span class="fu">:</span> <span class="st">&quot;invalid_request&quot;</span><span class="fu">,</span>
  <span class="dt">&quot;code&quot;</span><span class="fu">:</span> <span class="st">&quot;422&quot;</span><span class="fu">,</span>
  <span class="dt">&quot;error_description&quot;</span><span class="fu">:</span> <span class="st">&quot;malformed item identifier provided: must be an URI&quot;</span><span class="fu">,</span>
  <span class="dt">&quot;error_uri&quot;</span><span class="fu">:</span> <span class="st">&quot;http://example.org/help/api&quot;</span>
<span class="fu">}</span></code></pre></div>
</section>
<section id="simple-data-types" class="level2">
<h2><span class="header-section-number">2.8</span> Simple data types</h2>
<p>The following data types are used to define request and response format:</p>
<dl>
<dt>string</dt>
<dd>A Unicode string. Strings MAY be empty.
</dd>
<dt>nonnegative integer</dt>
<dd>An integer number larger than or equal to zero.
</dd>
<dt>boolean</dt>
<dd>Either true or false. Note that omitted boolean values are <em>not</em> false by default but unknown!
</dd>
<dt>date</dt>
<dd>A date value in <code>YYYY-MM-DD</code> format. A datetime value with time and timezone SHOULD be used instead, if possible.
</dd>
<dt>datetime</dt>
<dd><p>A date value in <code>YYY-MM-DD</code> format, optionally followed by a time value. A time value consists of the letter <code>T</code> followed by <code>hh:mm:ss</code> format, and a timezone indicator (<code>Z</code> for UTC or <code>+hh:mm</code> or <code>-hh:mm</code>) where:</p>
<ul>
<li><code>YYYY</code> indicates a year (<code>0001</code> through <code>9999</code>)</li>
<li><code>MM</code> indicates a month (<code>01</code> through <code>12</code>)</li>
<li><code>DD</code> indicates a day (<code>01</code> through <code>31</code>)</li>
<li><code>hh</code> indicates an hour (<code>00</code> through <code>23</code>)</li>
<li><code>mm</code> indicates a minute (<code>00</code> through <code>59</code>)</li>
<li><code>ss</code> indicates a second (<code>00</code> through <code>59</code>)</li>
</ul>
<p>Examples of valid datetime values include <code>2015-03-20</code> (a date), <code>2016-03-09T11:58:19+10:00</code>, and <code>2017-08-21T12:24:28-06:00</code>.</p>
</dd>
<dt>money</dt>
<dd>A monetary value with currency (format <code>[0-9]+\.[0-9][0-9] [A-Z][A-Z][A-Z]</code>), for instance <code>0.80 USD</code>.
</dd>
<dt>email</dt>
<dd>A syntactically correct email address.
</dd>
<dt>URI</dt>
<dd>A syntactically correct URI.
</dd>
<dt>account state</dt>
<dd><p>A nonnegative integer representing the current state of a patron account. Possible values are:</p>
<ol start="0" type="1">
<li>active</li>
<li>inactive</li>
<li>inactive because account expired</li>
<li>inactive because of outstanding fees</li>
<li>inactive because account expired and outstanding fees</li>
</ol>
<p>A PAIA server MAY define additional states which can be mapped to <code>1</code> by PAIA clients. In JSON account states MUST be encoded as numbers instead of strings.</p>
</dd>
<dt>service status</dt>
<dd><p>A nonnegative integer representing the current status in fulfillment of a service. In most cases the service is related to a document, so the service status is a relation between a particular document and a particular patron. Possible values are:</p>
<ol start="0" type="1">
<li>no relation (this applies to most combinations of document and patron, and it can be expected if no other state is given)</li>
<li>reserved (the document is not accessible for the patron yet, but it will be)</li>
<li>ordered (the document is being made accessible for the patron)</li>
<li>held (the document is on loan by the patron)</li>
<li>provided (the document is ready to be used by the patron)</li>
<li>rejected</li>
</ol>
<p>A PAIA server MUST NOT define any other service status. In JSON service status MUST be encoded as numbers instead of strings.</p>
</dd>
</dl>
</section>
<section id="documents" class="level2">
<h2><span class="header-section-number">2.9</span> Documents</h2>
<p>A <strong>document</strong> is a key-value structure with the following fields:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">name</th>
<th style="text-align: left;">occ</th>
<th style="text-align: center;">data type</th>
<th style="text-align: center;">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>status</td>
<td style="text-align: left;">1..1</td>
<td>service status</td>
<td>status (0, 1, 2, 3, 4, or 5)</td>
</tr>
<tr class="even">
<td>item</td>
<td style="text-align: left;">0..1</td>
<td>URI</td>
<td>URI of a particular copy</td>
</tr>
<tr class="odd">
<td>edition</td>
<td style="text-align: left;">0..1</td>
<td>URI</td>
<td>URI of a the document (no particular copy)</td>
</tr>
<tr class="even">
<td>requested</td>
<td style="text-align: left;">0..1</td>
<td>URI</td>
<td>URI that was originally requested</td>
</tr>
<tr class="odd">
<td>about</td>
<td style="text-align: left;">0..1</td>
<td>string</td>
<td>textual description of the document</td>
</tr>
<tr class="even">
<td>label</td>
<td style="text-align: left;">0..1</td>
<td>string</td>
<td>call number, shelf mark or similar item label</td>
</tr>
<tr class="odd">
<td>comment</td>
<td style="text-align: left;">0..1</td>
<td>string</td>
<td>comment on this document or its processing</td>
</tr>
<tr class="even">
<td>queue</td>
<td style="text-align: left;">0..1</td>
<td>nonnegative integer</td>
<td>number of waiting requests for the document or item</td>
</tr>
<tr class="odd">
<td>renewals</td>
<td style="text-align: left;">0..1</td>
<td>nonnegative integer</td>
<td>number of times the document has been renewed</td>
</tr>
<tr class="even">
<td>reminder</td>
<td style="text-align: left;">0..1</td>
<td>nonnegative integer</td>
<td>number of times the patron has been reminded</td>
</tr>
<tr class="odd">
<td>starttime</td>
<td style="text-align: left;">0..1</td>
<td>datetime</td>
<td>date and time when the status began</td>
</tr>
<tr class="even">
<td>endtime</td>
<td style="text-align: left;">0..1</td>
<td>datetime</td>
<td>date and time when the status will expire</td>
</tr>
<tr class="odd">
<td>cancancel</td>
<td style="text-align: left;">0..1</td>
<td>boolean</td>
<td>whether an ordered or provided document can be canceled</td>
</tr>
<tr class="even">
<td>canrenew</td>
<td style="text-align: left;">0..1</td>
<td>boolean</td>
<td>whether a document can be renewed</td>
</tr>
<tr class="odd">
<td>error</td>
<td style="text-align: left;">0..1</td>
<td>string</td>
<td>textual document error, for instance if a request was rejected</td>
</tr>
<tr class="even">
<td>condition</td>
<td style="text-align: left;">0..1</td>
<td><a href="#conditions-and-confirmations">condition</a></td>
<td>condition (only in responses to <a href="#request">request</a>, <a href="#renew">renew</a>, or <a href="#cancel">cancel</a>)</td>
</tr>
<tr class="odd">
<td>storage</td>
<td style="text-align: left;">0..1</td>
<td>string</td>
<td>textual description of location of the document</td>
</tr>
<tr class="even">
<td>storageid</td>
<td style="text-align: left;">0..1</td>
<td>URI</td>
<td>URI of location of the document</td>
</tr>
</tbody>
</table>
<p>For each document at least an item URI or an edition URI MUST be given. Together, item and edition URI MUST uniquely identify a document within the set of documents related to a patron.</p>
<p>The fields <code>starttime</code> and <code>endtime</code> MUST be interpreted as following:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">status</th>
<th style="text-align: center;">starttime</th>
<th style="text-align: center;">endtime</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>-</td>
<td>-</td>
</tr>
<tr class="even">
<td>1</td>
<td>when the document was reserved</td>
<td>when the reserved document is expected to be available</td>
</tr>
<tr class="odd">
<td>2</td>
<td>when the document was ordered</td>
<td>when the ordered document is expected to be available</td>
</tr>
<tr class="even">
<td>3</td>
<td>when the document was lend</td>
<td>when the loan period ends or ended (due)</td>
</tr>
<tr class="odd">
<td>4</td>
<td>when the document is provided</td>
<td>when the provision will expire</td>
</tr>
<tr class="even">
<td>5</td>
<td>when the request was rejected</td>
<td>-</td>
</tr>
</tbody>
</table>
<p>Note that timezone information is mandatory in these fields.</p>
<p>If both <code>storage</code> and <code>storageid</code> are given, a PAIA server MUST return identical values of <code>storage</code> for identical <code>id</code> and identical content language. PAIA clients MAY override the value of <code>storage</code> based on <code>storageid</code> and a preferred language.</p>
<p>Unknown document URIs and failed attempts to request, renew, or cancel a document MUST NOT result in a <a href="#request-errors">request error</a>. Instead they are indicated by a document error with field <code>error</code>. Form and type of document errors are not specified, so clients SHOULD use these notifications for display only.</p>
<p>If <code>condition</code> is given, a PAIA server MUST also include a document error for the same document, for instance the error notification “confirmation required”. This allows PAIA clients without support of <a href="#conditions-and-confirmations">conditions and conformations</a> to treat conditions as simple, unrecoverable document errors.</p>
<div class="example">
<p>An example of a document serialized in JSON is given below. In this case a general document (<code>http://example.org/documents/9876543</code>) was requested an mapped to a particular copy (<code>http://example.org/items/barcode1234567</code>) by the PAIA server. The copy turned out to be lost, so the request was rejected (status 5) at 2014-07-12, 14:07 UTC.</p>
<div class="sourceCode"><pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
   <span class="dt">&quot;status&quot;</span><span class="fu">:</span>    <span class="dv">5</span><span class="fu">,</span>
   <span class="dt">&quot;item&quot;</span><span class="fu">:</span>      <span class="st">&quot;http://example.org/items/barcode1234567&quot;</span><span class="fu">,</span>
   <span class="dt">&quot;edition&quot;</span><span class="fu">:</span>   <span class="st">&quot;http://example.org/documents/9876543&quot;</span><span class="fu">,</span>
   <span class="dt">&quot;requested&quot;</span><span class="fu">:</span> <span class="st">&quot;http://example.org/documents/9876543&quot;</span><span class="fu">,</span>
   <span class="dt">&quot;starttime&quot;</span><span class="fu">:</span> <span class="st">&quot;2014-07-12T14:07Z&quot;</span><span class="fu">,</span>
   <span class="dt">&quot;error&quot;</span><span class="fu">:</span>     <span class="st">&quot;Sorry, we found out that our copy is lost!&quot;</span>
<span class="fu">}</span></code></pre></div>
<p>The following document could result from a <a href="#request">request</a> for an item given by an unknown URI:</p>
<div class="sourceCode"><pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
  <span class="dt">&quot;item&quot;</span><span class="fu">:</span> <span class="st">&quot;http://example.org/some/uri&quot;</span><span class="fu">,</span>
  <span class="dt">&quot;error&quot;</span><span class="fu">:</span> <span class="st">&quot;item URI not found&quot;</span>
<span class="fu">}</span></code></pre></div>
</div>
</section>
<section id="patron-notification" class="level2">
<h2><span class="header-section-number">2.10</span> Notifications</h2>
<p>A <strong>notification</strong> is a key-value structure with the following fields:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: left;">occ</th>
<th>data type</th>
<th style="text-align: left;">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">id</td>
<td style="text-align: left;">1..1</td>
<td>URI</td>
<td style="text-align: left;">unique notification identifier as URI</td>
</tr>
<tr class="even">
<td style="text-align: left;">about</td>
<td style="text-align: left;">1..1</td>
<td>string</td>
<td style="text-align: left;">notification text without markup</td>
</tr>
<tr class="odd">
<td style="text-align: left;">date</td>
<td style="text-align: left;">1..1</td>
<td>datetime</td>
<td style="text-align: left;">notification date</td>
</tr>
<tr class="even">
<td style="text-align: left;">item</td>
<td style="text-align: left;">0..1</td>
<td>URI</td>
<td style="text-align: left;">item that is related to the notification</td>
</tr>
<tr class="odd">
<td style="text-align: left;">url</td>
<td style="text-align: left;">0..1</td>
<td>URL</td>
<td style="text-align: left;">URL of a human-readable page with more information</td>
</tr>
</tbody>
</table>
<p>The unique notification identifier MUST have the form</p>
<blockquote>
<p><code>{base}{uri_escaped_patron_identifier}/notifications/{local_part}</code></p>
</blockquote>
<p>where <code>base</code> is the PAIA core base URL and <code>local_part</code> is a local identifier, for instance a random number. The local part SHOULD consist of digits (<code>0-9</code>), simple letters (<code>a-z</code>, <code>A-Z</code>), and hyphens (<code>-</code>) only.</p>
<p>Notifications can be read and deleted with PAIA core method <a href="#notifications">notifications</a>.</p>
</section>
<section id="conditions-and-confirmations" class="level2">
<h2><span class="header-section-number">2.11</span> Conditions and confirmations</h2>
<p>Conditions and confirmations can OPTIONALLY be used to require or to select from additional options in <a href="#paia-core">PAIA core</a> methods <a href="#request">request</a>, <a href="#renew">renew</a>, and <a href="#cancel">cancel</a>. For instance a PAIA server MAY allow to choose among multiple delivery methods or it MAY require to explicitly agree to some terms of services when a special document is requested. A PAIA client without support of conditions and confirmations will always be assigned to the default option or it will experience a condition as <a href="#documents">document error</a> if no default option is available.</p>
<section id="conditions" class="level3 unnumbered">
<h3>Conditions</h3>
<p>A <strong>condition</strong> is a key-value structure that maps condition types to condition settings.</p>
<p>Conditions can be included in response field <code>condition</code> of a <a href="#documents">document</a> if the same document also includes a document error in field <code>error</code>. The error SHOULD provide a short description of the condition, for instance “delivery type must be selected” or “confirmation required”.</p>
<p>A <strong>condition type</strong> is an URI that identifies the purpose of a condition. A PAIA client MUST be able to handle arbitrary condition type URIs. A PAIA server SHOULD support at least the following two condition types:</p>
<ul>
<li><a href="http://purl.org/ontology/paia#StorageCondition" class="uri">http://purl.org/ontology/paia#StorageCondition</a> to select a document location</li>
<li><a href="http://purl.org/ontology/paia#FeeCondition" class="uri">http://purl.org/ontology/paia#FeeCondition</a> to confirm or select a document service causing a fee</li>
</ul>
<p>A <strong>condition setting</strong> is a key-value structure with the following keys:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">name</th>
<th style="text-align: left;">occ</th>
<th style="text-align: left;">data type</th>
<th style="text-align: center;">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>option</td>
<td style="text-align: left;">1..n</td>
<td style="text-align: left;">condition option</td>
<td>list of condition options</td>
</tr>
<tr class="even">
<td>multiple</td>
<td style="text-align: left;">0..1</td>
<td style="text-align: left;">boolean</td>
<td>whether multiple options can be selected</td>
</tr>
<tr class="odd">
<td>default</td>
<td style="text-align: left;">0..n</td>
<td style="text-align: left;">URI</td>
<td>set of default option identifiers</td>
</tr>
</tbody>
</table>
<p>A missing field <code>multiple</code> MUST be treated equal to a <code>multiple</code> field with value <code>false</code>. The field <code>default</code> MAY be an empty array — this case MUST NOT be confused with a missing field <code>default</code>. All URIs listed in field <code>default</code> MUST also be included as field <code>id</code> of one condition option.</p>
<p>If multiple condition options are given, they SHOULD be ordered, for instance by popularity.</p>
<p>A <strong>condition option</strong> is a key-value structure with the following keys:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">name</th>
<th style="text-align: right;">occ</th>
<th style="text-align: right;">data type</th>
<th style="text-align: center;">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>id</td>
<td style="text-align: right;">1..1</td>
<td style="text-align: right;">URI</td>
<td>unique identifier of this option</td>
</tr>
<tr class="even">
<td>about</td>
<td style="text-align: right;">1..1</td>
<td style="text-align: right;">string</td>
<td>textual description or label of this option</td>
</tr>
<tr class="odd">
<td>amount</td>
<td style="text-align: right;">0..1</td>
<td style="text-align: right;">money</td>
<td>fee implied by chosing this option</td>
</tr>
</tbody>
</table>
<p>A condition setting MUST NOT contain multiple condition options with same <code>id</code>. A PAIA server MUST return identical values of <code>about</code> for identical values of <code>id</code> and identical content language. PAIA clients MAY override the value of <code>about</code> based on <code>id</code> and a preferred language.</p>
<p>Values of <code>amout</code> matching the regular expression <code>/^0+\.00/</code> MUST be treated equal to no amount and vice versa.</p>
<p>A PAIA server SHOULD use the condition option id <a href="http://purl.org/ontology/dso#DocumentService" class="uri">http://purl.org/ontology/dso#DocumentService</a> or other URIs from the <a href="http://gbv.github.io/dso/">Document Service Ontology</a> for condition options of type <a href="http://purl.org/ontology/paia#FeeCondition" class="uri">http://purl.org/ontology/paia#FeeCondition</a>. Id and amount of the selected condition option SHOULD later occurr in response to request method <a href="#fees">fees</a>.</p>
<div class="example">
<p>Most simple condition only contain a single condition type. In the following example condition type <a href="http://purl.org/ontology/paia#FeeCondition" class="uri">http://purl.org/ontology/paia#FeeCondition</a> is mapped to a condition setting with one condition option. No default option is given, so an explicit confirmation is required.</p>
<div class="sourceCode"><pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
  <span class="dt">&quot;http://purl.org/ontology/paia#FeeCondition&quot;</span><span class="fu">:</span> <span class="fu">{</span>
    <span class="dt">&quot;option&quot;</span><span class="fu">:</span> <span class="ot">[</span>
      <span class="fu">{</span>
        <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;http://purl.org/ontology/dso#Loan&quot;</span><span class="fu">,</span>
        <span class="dt">&quot;about&quot;</span><span class="fu">:</span> <span class="st">&quot;loan&quot;</span><span class="fu">,</span>
        <span class="dt">&quot;amount&quot;</span><span class="fu">:</span> <span class="st">&quot;0.50 EUR&quot;</span>
      <span class="fu">}</span>
    <span class="ot">]</span>
  <span class="fu">}</span>
<span class="fu">}</span></code></pre></div>
<p>The following condition contains two condition types. The first condition type (<a href="http://purl.org/ontology/paia#StorageCondition" class="uri">http://purl.org/ontology/paia#StorageCondition</a>) refers to a list of delivery places. The first place is marked as default and the third place implies a fee. The second condition type (<a href="http://example.org/purpose" class="uri">http://example.org/purpose</a>) lists two options which can also be selected together. An empty set is given as default option.</p>
<div class="sourceCode"><pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
  <span class="dt">&quot;http://purl.org/ontology/paia#StorageCondition&quot;</span><span class="fu">:</span> <span class="fu">{</span>
    <span class="dt">&quot;option&quot;</span><span class="fu">:</span> <span class="ot">[</span>
      <span class="fu">{</span>
        <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;http://example.org/locations/pickup-desk&quot;</span><span class="fu">,</span>
        <span class="dt">&quot;about&quot;</span><span class="fu">:</span> <span class="st">&quot;pickup desk&quot;</span>
      <span class="fu">}</span><span class="ot">,</span>
      <span class="fu">{</span>
        <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;http://example.org/locations/branch&quot;</span><span class="fu">,</span>
        <span class="dt">&quot;about&quot;</span><span class="fu">:</span> <span class="st">&quot;branch office&quot;</span>
      <span class="fu">}</span><span class="ot">,</span>
      <span class="fu">{</span>
        <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;http://example.org/services/home-delivery&quot;</span><span class="fu">,</span>
        <span class="dt">&quot;amount&quot;</span><span class="fu">:</span> <span class="st">&quot;2.50 EUR&quot;</span><span class="fu">,</span>
        <span class="dt">&quot;about&quot;</span><span class="fu">:</span> <span class="st">&quot;home delivery&quot;</span>
      <span class="fu">}</span>
    <span class="ot">]</span><span class="fu">,</span>
    <span class="dt">&quot;default&quot;</span><span class="fu">:</span> <span class="ot">[</span> <span class="st">&quot;http://example.org/locations/pickup-desk&quot;</span> <span class="ot">]</span>
  <span class="fu">},</span>
  <span class="dt">&quot;http://example.org/purpose&quot;</span><span class="fu">:</span> <span class="fu">{</span>
    <span class="dt">&quot;multiple&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span>
    <span class="dt">&quot;option&quot;</span><span class="fu">:</span> <span class="ot">[</span>
      <span class="fu">{</span>
        <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;http://example.org/purpose/research&quot;</span><span class="fu">,</span>
        <span class="dt">&quot;about&quot;</span><span class="fu">:</span> <span class="st">&quot;document usage for research&quot;</span>
      <span class="fu">}</span><span class="ot">,</span>
      <span class="fu">{</span>
        <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;http://example.org/purpose/leisure&quot;</span><span class="fu">,</span>
        <span class="dt">&quot;about&quot;</span><span class="fu">:</span> <span class="st">&quot;document usage for leisure&quot;</span>
      <span class="fu">}</span>
    <span class="ot">]</span><span class="fu">,</span>
    <span class="dt">&quot;default&quot;</span><span class="fu">:</span> <span class="ot">[</span> <span class="ot">]</span>
  <span class="fu">}</span>
<span class="fu">}</span></code></pre></div>
</div>
</section>
<section id="confirmations" class="level3 unnumbered">
<h3>Confirmations</h3>
<p>Confirmations can be sent as part of a <a href="#paia-core">PAIA core</a> request of methods <a href="#request">request</a>, <a href="#renew">renew</a>, and <a href="#cancel">cancel</a> in field <code>confirm</code> of a document to choose among condition options for selected condition types.</p>
<p>A <strong>confirmation</strong> is a key-value structure that maps <a href="#conditions">condition types</a> to (possibly empty) sets of identifiers of selected <a href="#conditions">condition options</a>.</p>
<div class="example">
<p>This confirmation confirms condition type <a href="http://purl.org/ontology/paia#FeeCondition" class="uri">http://purl.org/ontology/paia#FeeCondition</a> with condition option identified by <a href="http://purl.org/ontology/dso#DocumentService" class="uri">http://purl.org/ontology/dso#DocumentService</a> and confirms another condition type with two options from the example condition given above:</p>
<div class="sourceCode"><pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
  <span class="dt">&quot;http://purl.org/ontology/paia#FeeCondition&quot;</span><span class="fu">:</span> <span class="ot">[</span>
    <span class="st">&quot;http://purl.org/ontology/dso#DocumentService&quot;</span>
  <span class="ot">]</span><span class="fu">,</span>
  <span class="dt">&quot;http://example.org/purpose&quot;</span><span class="fu">:</span> <span class="ot">[</span>
    <span class="st">&quot;http://example.org/purpose/research&quot;</span><span class="ot">,</span>
    <span class="st">&quot;http://example.org/purpose/leisure&quot;</span>
  <span class="ot">]</span>
<span class="fu">}</span></code></pre></div>
</div>
<div class="note">
<p>Valid confirmations can be empty, which is distinct from a missing confirmation. Confirmations can also contain empty lists of option identifiers:</p>
<div class="sourceCode"><pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span> <span class="fu">}</span>
<span class="fu">{</span> <span class="dt">&quot;http://purl.org/ontology/paia#FeeCondition&quot;</span><span class="fu">:</span> <span class="ot">[</span> <span class="ot">]</span> <span class="fu">}</span></code></pre></div>
</div>
</section>
<section id="how-conditions-are-met" class="level3 unnumbered">
<h3>How conditions are met</h3>
<p>A PAIA server MUST use the following algorithm or an equivalent mechanism to check whether a given <a href="#conditions-and-confirmations">condition</a> is met by a given <a href="#conditions-and-confirmations">confirmation</a> or by a missing <code>confirm</code> field. If a condition is not met, the server MUST return a <a href="#documents">document error</a> for the given document.</p>
<ol type="1">
<li><p>If no confirmation is given, a default confirmation is created by mapping all condition types to the default values of their condition settings.</p></li>
<li><p>All condition types in the conformation are removed, unless they have a correspondence in the condition.</p></li>
<li><p>All condition option identifiers in the conformation are removed, unless they also occur in the condition settings of the corresponding condition.</p></li>
<li><p>If the confirmation contains multiple condition option identifiers for a condition type that does not have a condition setting with field <code>multiple</code> set to <code>true</code>, all but the first identifier are removed.</p></li>
<li><p>The condition is not met, if there is a condition type in the condition without correspondence in the confirmation.</p></li>
<li><p>The condition is met if for each condition setting either field <code>default</code> is set to the empty array (<code>[ ]</code>) or the corresponding list of remaining option identifiers in the confirmation is not empty.</p></li>
</ol>
<div class="note">
<p>To not select any default confirmation options, a PAIA client can send an empty object (<code>{ }</code>).</p>
<p>Non applying condition types or options in a confirmation are ignored, so a PAIA client can choose to <em>always</em> sent some custom default confirmation.</p>
</div>
<div class="example">
<p>The following condition contains the empty set as default value, so it is met by <em>any</em> confirmation except a confirmation that does <em>not</em> include condition type <a href="http://example.org/purpose" class="uri">http://example.org/purpose</a> (for instance <code>{ }</code>):</p>
<div class="sourceCode"><pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
  <span class="dt">&quot;http://example.org/purpose&quot;</span><span class="fu">:</span> <span class="fu">{</span>
    <span class="dt">&quot;multiple&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span>
    <span class="dt">&quot;option&quot;</span><span class="fu">:</span> <span class="ot">[</span>
      <span class="fu">{</span> <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;http://example.org/research&quot;</span><span class="fu">,</span> <span class="dt">&quot;about&quot;</span><span class="fu">:</span> <span class="st">&quot;for research&quot;</span> <span class="fu">}</span><span class="ot">,</span>
      <span class="fu">{</span> <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;http://example.org/leisure&quot;</span><span class="fu">,</span> <span class="dt">&quot;about&quot;</span><span class="fu">:</span> <span class="st">&quot;for leisure&quot;</span> <span class="fu">}</span>
    <span class="ot">]</span><span class="fu">,</span>
    <span class="dt">&quot;default&quot;</span><span class="fu">:</span> <span class="ot">[</span> <span class="ot">]</span>
  <span class="fu">}</span></code></pre></div>
<p>All other possible confirmations are reduced to one of this cases (the first also used if no confirmation is given):</p>
<pre><code>{ &quot;http://example.org/purpose&quot;: [ ] }
{ &quot;http://example.org/purpose&quot;: [ &quot;http://example.org/research&quot; ] }
{ &quot;http://example.org/purpose&quot;: [ &quot;http://example.org/leisure&quot; ] }
{ &quot;http://example.org/purpose&quot;: [ &quot;http://example.org/research&quot;, &quot;http://example.org/leisure&quot; ] }</code></pre>
</div>
</section>
</section>
</section>
<section id="paia-core" class="level1">
<h1><span class="header-section-number">3</span> PAIA core</h1>
<p>Each API method of PAIA core is accessed at a URL that includes the URI escaped patron identifier.</p>
<section id="patron" class="level2">
<h2><span class="header-section-number">3.1</span> patron</h2>
<dl>
<dt>purpose</dt>
<dd>Get general information about a patron
</dd>
<dt>HTTP verb and URL</dt>
<dd>GET https://example.org/core/<strong>{uri_escaped_patron_identifier}</strong>
</dd>
<dt>scope</dt>
<dd>read_patron
</dd>
<dt>response fields</dt>
<dd><table>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: left;">occ</th>
<th style="text-align: left;">data type</th>
<th style="text-align: left;">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">name</td>
<td style="text-align: left;">1..1</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">full name of the patron</td>
</tr>
<tr class="even">
<td style="text-align: left;">email</td>
<td style="text-align: left;">0..1</td>
<td style="text-align: left;">email</td>
<td style="text-align: left;">email address of the patron</td>
</tr>
<tr class="odd">
<td style="text-align: left;">address</td>
<td style="text-align: left;">0..1</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">freeform address of the patron</td>
</tr>
<tr class="even">
<td style="text-align: left;">expires</td>
<td style="text-align: left;">0..1</td>
<td style="text-align: left;">datetime</td>
<td style="text-align: left;">patron account expiry</td>
</tr>
<tr class="odd">
<td style="text-align: left;">status</td>
<td style="text-align: left;">0..1</td>
<td style="text-align: left;">account state</td>
<td style="text-align: left;">current state (0, 1, 2, or 3)</td>
</tr>
<tr class="even">
<td style="text-align: left;">type</td>
<td style="text-align: left;">0..n</td>
<td style="text-align: left;">URI</td>
<td style="text-align: left;">list of custom URIs to identify patron types</td>
</tr>
<tr class="odd">
<td style="text-align: left;">note</td>
<td style="text-align: left;">0..1</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">simple note to inform the patron</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<p>PAIA server documentation SHOULD refer to a specialized API, such as LDAP, to get more detailed patron information.</p>
<div class="example">
<pre><code>GET /core/123 HTTP/1.1
Host: example.org
User-Agent: MyPAIAClient/1.0
Accept: application/json
Authorization: Bearer a0dedc54bbfae4b</code></pre>
<pre><code>HTTP/1.1 200 OK
X-PAIA-Version: 1.4.0
Content-Type: application/json; charset=utf-8
X-Accepted-OAuth-Scopes: read_patron
X-OAuth-Scopes: read_fees read_items read_patron write_items read_notifications delete_notifications</code></pre>
<div class="sourceCode"><pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
  <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;Jane Q. Public&quot;</span><span class="fu">,</span>
  <span class="dt">&quot;email&quot;</span><span class="fu">:</span> <span class="st">&quot;jane@example.org&quot;</span><span class="fu">,</span>
  <span class="dt">&quot;address&quot;</span><span class="fu">:</span> <span class="st">&quot;Park Street 2, Springfield&quot;</span><span class="fu">,</span>
  <span class="dt">&quot;expires&quot;</span><span class="fu">:</span> <span class="st">&quot;2015-05-18&quot;</span><span class="fu">,</span>
  <span class="dt">&quot;status&quot;</span><span class="fu">:</span> <span class="dv">0</span><span class="fu">,</span>
  <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;http://example.org/usertypes/default&quot;</span><span class="ot">]</span>
<span class="fu">}</span></code></pre></div>
</div>
</section>
<section id="update-patron" class="level2">
<h2><span class="header-section-number">3.2</span> update patron</h2>
<dl>
<dt>purpose</dt>
<dd>Update general information about a patron
</dd>
<dt>HTTP verb and URL</dt>
<dd>PATCH https://example.org/core/<strong>{uri_escaped_patron_identifier}</strong>
</dd>
<dt>scopes</dt>
<dd>update_patron / update_patron_name / update_patron_email / update_patron_address
</dd>
<dt>request parameters</dt>
<dd><table>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: left;">occ</th>
<th>data type</th>
<th style="text-align: center;">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">name</td>
<td style="text-align: left;">0..1</td>
<td>string</td>
<td>new full name of the patron</td>
</tr>
<tr class="even">
<td style="text-align: left;">email</td>
<td style="text-align: left;">0..1</td>
<td>email</td>
<td>new email address of the patron</td>
</tr>
<tr class="odd">
<td style="text-align: left;">address</td>
<td style="text-align: left;">0..1</td>
<td>string</td>
<td>new freeform address of the patron</td>
</tr>
</tbody>
</table>
</dd>
<dt>response fields</dt>
<dd>Same as <a href="#patron">patron</a> method on success, <a href="#request-errors">error</a> otherwise.
</dd>
</dl>
<p>This PAIA core method can be used to modify parts of the general patron information: Fields “name”, “email”, and “address” can be changed with scope <code>update_patron</code> for all of these fields, or with the scopes <code>update_patron_name</code>, <code>update_patron_email</code>, and/or <code>update_patron_address</code> for each corresponding field.</p>
<p>This PAIA core method will be introduced with PAIA 1.4.0. A PAIA server MAY chose not not implement this method and return an <a href="#request-errors">error response</a> with error code <code>access_denied</code> (403), <code>invalid_request</code> (405), or <code>not_implemented</code> (501) instead.</p>
<div class="note">
<p>Update of patron fields expires, status, and type via this method is not supported. To change a patron password see methods <a href="#change">change</a> and <a href="#reset">reset</a> of PAIA auth.</p>
</div>
<div class="example">
<pre><code>PATCH /core/123 HTTP/1.1
Host: example.org
User-Agent: MyPAIAClient/1.0
Accept: application/json
Content-Type: application/json
Authorization: Bearer 08568be488a2539</code></pre>
<div class="sourceCode"><pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
  <span class="dt">&quot;email&quot;</span><span class="fu">:</span> <span class="st">&quot;janes-new-mail@example.com&quot;</span>
<span class="fu">}</span></code></pre></div>
<pre><code>HTTP/1.1 200 OK
X-PAIA-Version: 1.4.0
Content-Type: application/json; charset=utf-8
X-Accepted-OAuth-Scopes: update_patron update_patron_email
X-OAuth-Scopes: read_patron update_patron</code></pre>
<div class="sourceCode"><pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
  <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;Jane Q. Public&quot;</span><span class="fu">,</span>
  <span class="dt">&quot;email&quot;</span><span class="fu">:</span> <span class="st">&quot;janes-new-mail@example.com&quot;</span><span class="fu">,</span>
  <span class="dt">&quot;address&quot;</span><span class="fu">:</span> <span class="st">&quot;Park Street 2, Springfield&quot;</span><span class="fu">,</span>
  <span class="dt">&quot;expires&quot;</span><span class="fu">:</span> <span class="st">&quot;2015-05-18&quot;</span><span class="fu">,</span>
  <span class="dt">&quot;status&quot;</span><span class="fu">:</span> <span class="dv">0</span><span class="fu">,</span>
  <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;http://example.org/usertypes/default&quot;</span><span class="ot">]</span>
<span class="fu">}</span></code></pre></div>
</div>
</section>
<section id="items" class="level2">
<h2><span class="header-section-number">3.3</span> items</h2>
<dl>
<dt>purpose</dt>
<dd>Get a list of loans, reservations and other items related to a patron
</dd>
<dt>HTTP verb and URL</dt>
<dd>GET https://example.org/core/<strong>{uri_escaped_patron_identifier}</strong>/items
</dd>
<dt>scope</dt>
<dd>read_item
</dd>
<dt>response fields</dt>
<dd><table>
<thead>
<tr class="header">
<th style="text-align: center;">name</th>
<th style="text-align: center;">occ</th>
<th style="text-align: right;">data type</th>
<th style="text-align: center;">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>doc</td>
<td>0..n</td>
<td style="text-align: right;"><a href="#documents">document</a></td>
<td>list of documents (order is irrelevant)</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<p>In most cases, each document will refer to a particular copy (<code>doc.item</code>), but users may also have requested (<code>doc.requested</code>) and/or reserved (<code>doc.edition</code>) an edition.</p>
<div class="example">
<pre><code>GET /core/123/items HTTP/1.1
Host: example.org
User-Agent: MyPAIAClient/1.0
Accept: application/json
Authorization: Bearer a0dedc54bbfae4b</code></pre>
<pre><code>HTTP/1.1 200 OK
Content-Type: application/json; charset=utf-8
X-PAIA-Version: 1.4.0
X-Accepted-OAuth-Scopes: read_patron
X-OAuth-Scopes: read_items read_patron</code></pre>
<div class="sourceCode"><pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
  <span class="dt">&quot;doc&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="fu">{</span>
    <span class="dt">&quot;status&quot;</span><span class="fu">:</span> <span class="dv">3</span><span class="fu">,</span>
    <span class="dt">&quot;item&quot;</span><span class="fu">:</span> <span class="st">&quot;http://bib.example.org/105359165&quot;</span><span class="fu">,</span>
    <span class="dt">&quot;edition&quot;</span><span class="fu">:</span> <span class="st">&quot;http://bib.example.org/9782356&quot;</span><span class="fu">,</span>
    <span class="dt">&quot;about&quot;</span><span class="fu">:</span> <span class="st">&quot;Maurice Sendak (1963): Where the wild things are&quot;</span><span class="fu">,</span>
    <span class="dt">&quot;label&quot;</span><span class="fu">:</span> <span class="st">&quot;Y B SEN 101&quot;</span><span class="fu">,</span>
    <span class="dt">&quot;queue&quot;</span><span class="fu">:</span> <span class="dv">0</span><span class="fu">,</span>
    <span class="dt">&quot;renewals&quot;</span><span class="fu">:</span> <span class="dv">0</span><span class="fu">,</span>
    <span class="dt">&quot;reminder&quot;</span><span class="fu">:</span> <span class="dv">0</span><span class="fu">,</span>
    <span class="dt">&quot;starttime&quot;</span><span class="fu">:</span> <span class="st">&quot;2014-05-08T12:37Z&quot;</span><span class="fu">,</span>
    <span class="dt">&quot;endtime&quot;</span><span class="fu">:</span> <span class="st">&quot;2014-06-09&quot;</span><span class="fu">,</span>
    <span class="dt">&quot;cancancel&quot;</span><span class="fu">:</span> <span class="kw">false</span><span class="fu">,</span>
  <span class="fu">}</span><span class="ot">,</span><span class="fu">{</span>
    <span class="dt">&quot;status&quot;</span><span class="fu">:</span> <span class="dv">1</span><span class="fu">,</span>
    <span class="dt">&quot;item&quot;</span><span class="fu">:</span> <span class="st">&quot;http://bib.example.org/8861930&quot;</span><span class="fu">,</span>
    <span class="dt">&quot;about&quot;</span><span class="fu">:</span> <span class="st">&quot;Janet B. Pascal (2013): Who was Maurice Sendak?&quot;</span><span class="fu">,</span>
    <span class="dt">&quot;label&quot;</span><span class="fu">:</span> <span class="st">&quot;BIO SED 03&quot;</span><span class="fu">,</span>
    <span class="dt">&quot;queue&quot;</span><span class="fu">:</span> <span class="dv">1</span><span class="fu">,</span>
    <span class="dt">&quot;starttime&quot;</span><span class="fu">:</span> <span class="st">&quot;2014-05-12T18:07Z&quot;</span><span class="fu">,</span>
    <span class="dt">&quot;endtime&quot;</span><span class="fu">:</span> <span class="st">&quot;2014-05-24&quot;</span><span class="fu">,</span>
    <span class="dt">&quot;cancancel&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span>
    <span class="dt">&quot;storage&quot;</span><span class="fu">:</span> <span class="st">&quot;pickup service desk&quot;</span><span class="fu">,</span>
    <span class="dt">&quot;storageid&quot;</span><span class="fu">:</span> <span class="st">&quot;http://bib.example.org/library/desk/7&quot;</span><span class="fu">,</span>
  <span class="fu">}</span><span class="ot">]</span>
<span class="fu">}</span></code></pre></div>
</div>
</section>
<section id="request" class="level2">
<h2><span class="header-section-number">3.4</span> request</h2>
<dl>
<dt>purpose</dt>
<dd>Request one or more items for reservation or delivery.
</dd>
<dt>HTTP verb and URL</dt>
<dd>POST https://example.org/core/<strong>{uri_escaped_patron_identifier}</strong>/request
</dd>
<dt>scope</dt>
<dd>write_item
</dd>
<dt>request parameters</dt>
<dd><table>
<thead>
<tr class="header">
<th style="text-align: center;">name</th>
<th style="text-align: center;">occ</th>
<th style="text-align: left;">data type</th>
<th style="text-align: left;">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>doc</td>
<td>1..n</td>
<td style="text-align: left;">array</td>
<td style="text-align: left;">list of documents requested</td>
</tr>
<tr class="even">
<td>doc.item</td>
<td>0..1</td>
<td style="text-align: left;">URI</td>
<td style="text-align: left;">URI of a particular item</td>
</tr>
<tr class="odd">
<td>doc.edition</td>
<td>0..1</td>
<td style="text-align: left;">URI</td>
<td style="text-align: left;">URI of a particular edition</td>
</tr>
<tr class="even">
<td>doc.confirm</td>
<td>0..1</td>
<td style="text-align: left;"><a href="#conditions-and-confirmations">confirmation</a></td>
<td style="text-align: left;">Confirmation</td>
</tr>
<tr class="odd">
<td>doc.comment</td>
<td>0..1</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">comment about the document or request</td>
</tr>
</tbody>
</table>
</dd>
<dt>response fields</dt>
<dd><table>
<thead>
<tr class="header">
<th style="text-align: center;">name</th>
<th style="text-align: center;">occ</th>
<th style="text-align: center;">data type</th>
<th style="text-align: center;">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>doc</td>
<td>1..n</td>
<td><a href="#documents">document</a></td>
<td>list of documents (order is irrelevant)</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<p>The response SHOULD include the same documents as requested. A client MAY also use the <a href="#items">items</a> method to get the service status after request.</p>
</section>
<section id="renew" class="level2">
<h2><span class="header-section-number">3.5</span> renew</h2>
<dl>
<dt>purpose</dt>
<dd>Renew one or more documents usually held by the patron. PAIA servers MAY also allow renewal of reserved, ordered, and provided documents.
</dd>
<dt>HTTP verb and URL</dt>
<dd>POST https://example.org/core/<strong>{uri_escaped_patron_identifier}</strong>/renew
</dd>
<dt>scope</dt>
<dd>write_item
</dd>
<dt>request parameters</dt>
<dd><table>
<tbody>
<tr class="odd">
<td>doc</td>
<td>1..n</td>
<td style="text-align: left;">array</td>
<td>list of documents to renew</td>
</tr>
<tr class="even">
<td>doc.item</td>
<td>0..1</td>
<td style="text-align: left;">URI</td>
<td>URI of a particular item</td>
</tr>
<tr class="odd">
<td>doc.edition</td>
<td>0..1</td>
<td style="text-align: left;">URI</td>
<td>URI of a particular edition</td>
</tr>
<tr class="even">
<td>doc.confirm</td>
<td>0..1</td>
<td style="text-align: left;"><a href="#conditions-and-confirmations">confirmation</a></td>
<td>Confirmation</td>
</tr>
<tr class="odd">
<td>doc.comment</td>
<td>0..1</td>
<td style="text-align: left;">string</td>
<td>comment about the document or renewal</td>
</tr>
</tbody>
</table>
</dd>
<dt>response fields</dt>
<dd><table>
<thead>
<tr class="header">
<th style="text-align: center;">name</th>
<th style="text-align: center;">occ</th>
<th style="text-align: right;">data type</th>
<th style="text-align: center;">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>doc</td>
<td>1..n</td>
<td style="text-align: right;"><a href="#documents">document</a></td>
<td>list of documents (order is irrelevant)</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<p>The response SHOULD include the same documents as requested.</p>
</section>
<section id="cancel" class="level2">
<h2><span class="header-section-number">3.6</span> cancel</h2>
<dl>
<dt>purpose</dt>
<dd>Cancel requests for items.
</dd>
<dt>HTTP verb and URL</dt>
<dd>POST https://example.org/core/<strong>{uri_escaped_patron_identifier}</strong>/cancel
</dd>
<dt>scope</dt>
<dd>write_item
</dd>
<dt>request parameters</dt>
<dd><table>
<thead>
<tr class="header">
<th style="text-align: center;">name</th>
<th style="text-align: center;">occ</th>
<th style="text-align: center;">data type</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>doc</td>
<td>1..n</td>
<td>array</td>
<td>list of documents to cancel</td>
</tr>
<tr class="even">
<td>doc.item</td>
<td>0..1</td>
<td>URI</td>
<td>URI of a particular item</td>
</tr>
<tr class="odd">
<td>doc.edition</td>
<td>0..1</td>
<td>URI</td>
<td>URI of a particular edition</td>
</tr>
<tr class="even">
<td>doc.confirm</td>
<td>0..1</td>
<td><a href="#conditions-and-confirmations">confirmation</a></td>
<td>Confirmation</td>
</tr>
<tr class="odd">
<td>doc.comment</td>
<td>0..1</td>
<td>string</td>
<td>comment about the document or cancelation</td>
</tr>
</tbody>
</table>
</dd>
<dt>response fields</dt>
<dd><table>
<thead>
<tr class="header">
<th style="text-align: center;">name</th>
<th style="text-align: center;">occ</th>
<th style="text-align: left;">data type</th>
<th style="text-align: center;">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>doc</td>
<td>1..n</td>
<td style="text-align: left;"><a href="#documents">document</a></td>
<td>list of documents (order is irrelevant)</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<p>The response SHOULD include the same documents as requested.</p>
</section>
<section id="fees" class="level2">
<h2><span class="header-section-number">3.7</span> fees</h2>
<dl>
<dt>purpose</dt>
<dd>Look up current fees of a patron.
</dd>
<dt>HTTP verb and URL</dt>
<dd>GET https://example.org/core/<strong>{uri_escaped_patron_identifier}</strong>/fees
</dd>
<dt>scope</dt>
<dd>read_fees
</dd>
<dt>response fields</dt>
<dd><table>
<thead>
<tr class="header">
<th style="text-align: center;">name</th>
<th style="text-align: center;">occ</th>
<th style="text-align: center;">data type</th>
<th style="text-align: center;">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>amount</td>
<td>0..1</td>
<td>money</td>
<td>sum of all fees. May also be negative.</td>
</tr>
<tr class="even">
<td>fee</td>
<td>0..n</td>
<td>array</td>
<td>list of fees</td>
</tr>
<tr class="odd">
<td>fee.amount</td>
<td>1..1</td>
<td>money</td>
<td>amount of a single fee</td>
</tr>
<tr class="even">
<td>fee.date</td>
<td>0..1</td>
<td>date</td>
<td>date when the fee was claimed</td>
</tr>
<tr class="odd">
<td>fee.about</td>
<td>0..1</td>
<td>string</td>
<td>textual information about the fee</td>
</tr>
<tr class="even">
<td>fee.item</td>
<td>0..1</td>
<td>URI</td>
<td>item that caused the fee</td>
</tr>
<tr class="odd">
<td>fee.edition</td>
<td>0..1</td>
<td>URI</td>
<td>edition that caused the fee</td>
</tr>
<tr class="even">
<td>fee.feetype</td>
<td>0..1</td>
<td>string</td>
<td>textual description of the type of service that caused the fee</td>
</tr>
<tr class="odd">
<td>fee.feeid</td>
<td>0..1</td>
<td>URI</td>
<td>URI of the type of service that caused the fee</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<p>A PAIA server MUST return identical values of <code>fee.feetype</code> for identical <code>fee.feeid</code> and identical content language. PAIA clients MAY override the value of <code>fee.feetype</code> based on <code>fee.feeid</code> and a preferred language.</p>
<p>If a fee was caused by a document (<code>fee.item</code> or <code>fee.edition</code> is set) then <code>fee.feeid</code> SHOULD be taken as <a href="http://purl.org/ontology/dso#DocumentService" class="uri">http://purl.org/ontology/dso#DocumentService</a> if not given and SHOULD be a class URI from the <a href="http://gbv.github.io/dso/">Document Service Ontology</a> otherwise. If the fee was confirmed with a <a href="#conditions-and-confirmations">confirmation</a>, the value of <code>fee.feeid</code> SHOULD be the value of the confirmed condition option.</p>
<div class="example">
<pre><code>GET /core/123/fees HTTP/1.1
Host: example.org
User-Agent: MyPAIAClient/1.0
Accept: application/json
Authorization: Bearer 90245facece931f</code></pre>
<pre><code>HTTP/1.1 200 OK
Content-Type: application/json; charset=utf-8
X-PAIA-Version: 1.4.0
X-Accepted-OAuth-Scopes: read_fees
X-OAuth-Scopes: read_patron read_items read_fees</code></pre>
<div class="sourceCode"><pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
  <span class="dt">&quot;amount&quot;</span><span class="fu">:</span> <span class="st">&quot;18.00 EUR&quot;</span><span class="fu">,</span>
  <span class="dt">&quot;fee&quot;</span><span class="fu">:</span> <span class="ot">[</span>
    <span class="fu">{</span>
      <span class="dt">&quot;amount&quot;</span><span class="fu">:</span> <span class="st">&quot;15.00 EUR&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;date&quot;</span><span class="fu">:</span> <span class="st">&quot;2016-05-13T00:00:00Z&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;about&quot;</span><span class="fu">:</span> <span class="st">&quot;annual fee&quot;</span>
    <span class="fu">}</span><span class="ot">,</span>
    <span class="fu">{</span>
      <span class="dt">&quot;amount&quot;</span><span class="fu">:</span> <span class="st">&quot;2.50 EUR&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;date&quot;</span><span class="fu">:</span> <span class="st">&quot;2016-08-01T13:17:02Z&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;item&quot;</span><span class="fu">:</span> <span class="st">&quot;http://bib.example.org/105359165&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;feeid&quot;</span><span class="fu">:</span> <span class="st">&quot;http://example.org/services/home-delivery&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;feetype&quot;</span><span class="fu">:</span> <span class="st">&quot;home delivery&quot;</span>
    <span class="fu">}</span><span class="ot">,</span>
    <span class="fu">{</span>
      <span class="dt">&quot;amount&quot;</span><span class="fu">:</span> <span class="st">&quot;0.50 EUR&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;date&quot;</span><span class="fu">:</span> <span class="st">&quot;2016-09-02T12:30:00Z&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;item&quot;</span><span class="fu">:</span> <span class="st">&quot;http://bib.example.org/105359165&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;about&quot;</span><span class="fu">:</span> <span class="st">&quot;late return&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;feeid&quot;</span><span class="fu">:</span> <span class="st">&quot;http://purl.org/ontology/dso#Loan&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;feetype&quot;</span><span class="fu">:</span> <span class="st">&quot;loan&quot;</span>
    <span class="fu">}</span>
  <span class="ot">]</span>
<span class="fu">}</span></code></pre></div>
</div>
<div class="note">
<p>PAIA core server are not required to track lists of fees. A plain sum can be returned as single value like this:</p>
<div class="sourceCode"><pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
  <span class="dt">&quot;amount&quot;</span><span class="fu">:</span> <span class="st">&quot;3.00 EUR&quot;</span><span class="fu">,</span>
  <span class="dt">&quot;fee&quot;</span><span class="fu">:</span> <span class="ot">[</span> <span class="fu">{</span> <span class="dt">&quot;amount&quot;</span><span class="fu">:</span> <span class="st">&quot;3.00 EUR&quot;</span> <span class="fu">}</span> <span class="ot">]</span>
<span class="fu">}</span></code></pre></div>
</div>
</section>
<section id="notifications" class="level2">
<h2><span class="header-section-number">3.8</span> notifications</h2>
<p>The PAIA core notifications method consists of three specific methods to <a href="#list-notifications">list notifications</a>, to <a href="#get-notification">get a notification</a>, and to <a href="#delete-notification">delete a notification</a>.</p>
<p>A PAIA server MAY use field <code>note</code> of method <a href="#patron">patron</a> as a simplified alternative to notifications. A PAIA server SHOULD NOT use both ways to transport the same notifications.</p>
<section id="list-notifications" class="level3">
<h3><span class="header-section-number">3.8.1</span> list notifications</h3>
<dl>
<dt>purpose</dt>
<dd>Look up all patron notifications
</dd>
<dt>HTTP verb and URL</dt>
<dd>GET https://example.org/core/<strong>{uri_escaped_patron_identifier}</strong>/notifications
</dd>
<dt>scope</dt>
<dd>read_notifications
</dd>
<dt>response</dt>
<dd><table>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: left;">occ</th>
<th style="text-align: left;">data type</th>
<th style="text-align: left;">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">notification</td>
<td style="text-align: left;">0..n</td>
<td style="text-align: left;"><a href="#patron-notification">notification</a></td>
<td style="text-align: left;">list of notifications (order is irrelevant)</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<div class="example">
<pre><code>GET /core/123/notifications HTTP/1.1
Host: example.org
User-Agent: MyPAIAClient/1.0
Accept: application/json
Authorization: Bearer 90245facece931f</code></pre>
<pre><code>HTTP/1.1 200 OK
Content-Type: application/json; charset=utf-8
X-PAIA-Version: 1.4.0
X-Accepted-OAuth-Scopes: read_notifications
X-OAuth-Scopes: read_patron read_items read_fees read_notifications</code></pre>
<div class="sourceCode"><pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
  <span class="dt">&quot;notification&quot;</span><span class="fu">:</span> <span class="ot">[</span>
    <span class="fu">{</span>
      <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;http://example.org/core/123/notifications/15&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;about&quot;</span><span class="fu">:</span> <span class="st">&quot;Your ordered item is ready for pickup at the service desk.&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;item&quot;</span><span class="fu">:</span> <span class="st">&quot;http://bib.example.org/8861930&quot;</span><span class="fu">,</span>       
      <span class="dt">&quot;date&quot;</span><span class="fu">:</span> <span class="st">&quot;2018-06-04T12:24:28-06:00&quot;</span>
    <span class="fu">}</span><span class="ot">,</span>
    <span class="fu">{</span>
      <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;http://example.org/core/123/notifications/17&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;about&quot;</span><span class="fu">:</span> <span class="st">&quot;We found your library card, please consult the service desk!&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;date&quot;</span><span class="fu">:</span> <span class="st">&quot;2018-07-02T09:45:03-04:21&quot;</span>
    <span class="fu">}</span><span class="ot">,</span>
    <span class="fu">{</span>
      <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;http://example.org/core/123/notifications/16&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;about&quot;</span><span class="fu">:</span> <span class="st">&quot;The copy you requested is lost. Sorry!&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;item&quot;</span><span class="fu">:</span> <span class="st">&quot;http://example.org/items/barcode1234567&quot;</span><span class="fu">,</span>
      <span class="dt">&quot;date&quot;</span><span class="fu">:</span> <span class="st">&quot;2018-06-10T16:15:03-01:00&quot;</span>
    <span class="fu">}</span>
  <span class="ot">]</span>
<span class="fu">}</span></code></pre></div>
</div>
</section>
<section id="get-notification" class="level3">
<h3><span class="header-section-number">3.8.2</span> get notification</h3>
<dl>
<dt>purpose</dt>
<dd>Get a patron notification
</dd>
<dt>HTTP verb and URL</dt>
<dd>GET https://example.org/core/<strong>{uri_escaped_patron_identifier}</strong>/notifications/<strong>{local_part}</strong>
</dd>
<dt>scope</dt>
<dd>read_notification
</dd>
<dt>response</dt>
<dd>JSON object of type <a href="#patron-notification">notification</a>
</dd>
</dl>
<div class="example">
<pre><code>GET /core/123/notifications/15 HTTP/1.1
Host: example.org
User-Agent: MyPAIAClient/1.0
Accept: application/json
Authorization: Bearer 90245facece931f</code></pre>
<pre><code>HTTP/1.1 200 OK
Content-Type: application/json; charset=utf-8
X-PAIA-Version: 1.4.0
X-Accepted-OAuth-Scopes: read_notifications
X-OAuth-Scopes: read_patron read_items read_fees read_notifications</code></pre>
<div class="sourceCode"><pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
  <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;http://example.org/core/123/notifications/15&quot;</span><span class="fu">,</span>
  <span class="dt">&quot;about&quot;</span><span class="fu">:</span> <span class="st">&quot;Your ordered item is ready for pickup at the service desk.&quot;</span><span class="fu">,</span>
  <span class="dt">&quot;item&quot;</span><span class="fu">:</span> <span class="st">&quot;http://bib.example.org/8861930&quot;</span><span class="fu">,</span>       
  <span class="dt">&quot;date&quot;</span><span class="fu">:</span> <span class="st">&quot;2018-06-04T12:24:28-06:00&quot;</span>
<span class="fu">}</span></code></pre></div>
</div>
</section>
<section id="delete-notification" class="level3">
<h3><span class="header-section-number">3.8.3</span> delete notification</h3>
<dl>
<dt>purpose</dt>
<dd>Delete a patron notification
</dd>
<dt>HTTP verb and URL</dt>
<dd>DELETE https://example.org/core/<strong>{uri_escaped_patron_identifier}</strong>/notifications/<strong>{local_part}</strong>
</dd>
<dt>scope</dt>
<dd>delete_notifications
</dd>
<dt>response</dt>
<dd>HTTP status code 204 without response body on success, <a href="#request-errors">error</a> otherwise.
</dd>
</dl>
<div class="example">
<pre><code>DELETE /core/123/notifications/16 HTTP/1.1
Host: example.org
User-Agent: MyPAIAClient/1.0
Accept: application/json
Authorization: Bearer 90245facece931f</code></pre>
<pre><code>HTTP/1.1 200 OK
Content-Type: application/json; charset=utf-8
X-PAIA-Version: 1.4.0
X-Accepted-OAuth-Scopes: delete_notifications read_notifications
X-OAuth-Scopes: read_patron read_items read_fees read_notifications delete_notifications</code></pre>
</div>
</section>
</section>
</section>
<section id="paia-auth" class="level1">
<h1><span class="header-section-number">4</span> PAIA auth</h1>
<p><strong>PAIA auth</strong> defines three methods to get access tokens and patron identifiers (<a href="#login">login</a>), invalidate access tokens (<a href="#logout">logout</a>), and change or reset passwords (<a href="#change">change</a> and <a href="#reset">reset</a>). Access tokens and patron identifiers are required to access <strong><a href="#paia-core">PAIA core</a></strong> methods. There MAY be additional or alternative ways to distribute and manage access tokens and patron identifiers.</p>
<p>A <strong>PAIA auth</strong> server acts as OAuth authorization server (<a href="http://tools.ietf.org/html/rfc6749">RFC 6749</a>) with password credentials grant, as defined in <a href="https://tools.ietf.org/html/rfc6749#section-4.3">section 4.3</a> of OAuth specification, and/or client credentials grant, as defined in <a href="https://tools.ietf.org/html/rfc6749#section-4.4">section 4.4</a> of the OAuth specification. The access tokens provided by the server are so called OAuth 2.0 bearer tokens (<a href="http://tools.ietf.org/html/rfc6750">RFC 6750</a>).</p>
<p>A <strong>PAIA auth</strong> server MUST protect against brute force attacks (e.g. using rate-limitation or generating alerts). It is RECOMMENDED to further restrict access to <strong>PAIA auth</strong> to specific clients, for instance by additional authorization.</p>
<section id="login" class="level2">
<h2><span class="header-section-number">4.1</span> login</h2>
<p>The PAIA auth <code>login</code> method is the only PAIA method that does not require an access token as part of the query. The URL of this method acts as OAuth Token Endpoint to obtain access tokens. A PAIA auth server can implement passwort credentials grant, client credentials grant, or both.</p>
<dl>
<dt>purpose</dt>
<dd>Get a patron identifier and access token to access patron information
</dd>
<dt>URL</dt>
<dd>POST https://example.org/auth/<strong>login</strong> (a PAIA auth server MAY also support HTTP GET requests)
</dd>
<dt>request header</dt>
<dd>The request header “Access” is required for client credentials grant with HTTP basic authentification as defined in <a href="http://tools.ietf.org/html/rfc2617">RFC 2617</a>.
</dd>
<dt>request parameters</dt>
<dd><table>
<thead>
<tr class="header">
<th style="text-align: center;">name</th>
<th style="text-align: center;">occ</th>
<th style="text-align: center;">data type</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>username</td>
<td>0..1</td>
<td>string</td>
<td>User name of a patron</td>
</tr>
<tr class="even">
<td>password</td>
<td>0..1</td>
<td>string</td>
<td>Password of a patron</td>
</tr>
<tr class="odd">
<td>patron</td>
<td>0..1</td>
<td>string</td>
<td>Patron identifier</td>
</tr>
<tr class="even">
<td>grant_type</td>
<td>1..1</td>
<td>string</td>
<td>One of “password” and “client_credentials”</td>
</tr>
<tr class="odd">
<td>scope</td>
<td>0..1</td>
<td>string</td>
<td>Space separated list of scopes</td>
</tr>
</tbody>
</table>
<p>For passwort credentials grant</p>
<ul>
<li>parameter “grant_type” MUST be set to “password”</li>
<li>parameters “username” and “password” are REQUIRED</li>
</ul>
<p>For client credentials grant</p>
<ul>
<li>parameter “grant_type” MUST be set to “client_credentials”</li>
<li>parameters “username” and “password” SHOULD be ignored</li>
</ul>
</dd>
</dl>
<p>The request parameter “patron” is only required if username or client credentials do not uniquely refer to a patron identifier. The parameter SHOULD be ignored otherwise. A username SHOULD uniquely identify a patron identifier. A username MAY even be equal to a patron identifier, but this is NOT RECOMMENDED.</p>
<p>If no <code>scope</code> parameter is given, and username or client credentials do not imply a default scope, the scope SHOULD be set to the default value <code>read_patron read_fees read_items write_items read_notifications delete_notifications</code> for full access to all PAIA core methods (see <a href="#access-tokens-and-scopes">access tokens and scopes</a>).</p>
<p>The response format is a JSON structure as defined in section 5.1 (successful response) and section 5.2 (error response) of OAuth 2.0. The PAIA auth server MAY grant different scopes than requested for, for instance if the account of a patron has expired, so the patron should not be allowed to request and renew new documents.</p>
<dl>
<dt>response fields</dt>
<dd><table>
<thead>
<tr class="header">
<th style="text-align: center;">name</th>
<th style="text-align: center;">occ</th>
<th style="text-align: center;">data type</th>
<th style="text-align: center;">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>patron</td>
<td>1..1</td>
<td>string</td>
<td>Patron identifier</td>
</tr>
<tr class="even">
<td>access_token</td>
<td>1..1</td>
<td>string</td>
<td>The access token issued by the PAIA auth server</td>
</tr>
<tr class="odd">
<td>token_type</td>
<td>1..1</td>
<td>string</td>
<td>Fixed value set to “Bearer” or “bearer”</td>
</tr>
<tr class="even">
<td>scope</td>
<td>1..1</td>
<td>string</td>
<td>Space separated list of granted scopes</td>
</tr>
<tr class="odd">
<td>expires_in</td>
<td>0..1</td>
<td>nonnegative integer</td>
<td>The lifetime in seconds of the access token</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<p>An access token SHOULD NOT be equal to the password of the same user.</p>
<p>If a PAIA server supports <a href="#reset">resetting passwords</a> it SHOULD be configured to allow getting access tokens with scope <code>reset_password</code> without request parameter <code>password</code>. In this case the server SHOULD also return tokens for non-existing patrons to avoid proping patron identifiers and/or user names.</p>
<div class="example">
<p>Successful login request with passwort grant:</p>
<pre><code>POST /auth/login HTTP/1.1
Host: example.org
User-Agent: MyPAIAClient/1.0
Accept: application/json
Content-Type: application/x-www-form-urlencoded</code></pre>
<pre><code>grant_type=password&amp;username=alice02&amp;password=jo-!97kdl%2B0tt</code></pre>
<pre><code>HTTP/1.1 200 OK
Content-Type: application/json; charset=utf-8
X-PAIA-Version: 1.4.0
X-OAuth-Scopes: read_patron read_fees read_items write_items read_notifications delete_notifications
Cache-Control: no-store
Pragma: no-cache</code></pre>
<div class="sourceCode"><pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
  <span class="dt">&quot;access_token&quot;</span><span class="fu">:</span> <span class="st">&quot;2YotnFZFEjr1zCsicMWpAA&quot;</span><span class="fu">,</span>
  <span class="dt">&quot;token_type&quot;</span><span class="fu">:</span> <span class="st">&quot;Bearer&quot;</span><span class="fu">,</span>
  <span class="dt">&quot;expires_in&quot;</span><span class="fu">:</span> <span class="dv">3600</span><span class="fu">,</span>
  <span class="dt">&quot;patron&quot;</span><span class="fu">:</span> <span class="st">&quot;8362432&quot;</span><span class="fu">,</span>
  <span class="dt">&quot;scope&quot;</span><span class="fu">:</span> <span class="st">&quot;read_patron read_fees read_items write_items read_notifications delete_notifications&quot;</span>
<span class="fu">}</span></code></pre></div>
<p>Login request with client credentials grant:</p>
<pre><code>POST /auth/login HTTP/1.1
Host: example.org
User-Agent: MyPAIAClient/1.0
Authorization: Basic b697689fa1adb419d86dbf8ffef9ce6d
Accept: application/json
Content-Type: application/x-www-form-urlencoded</code></pre>
<pre><code>grant_type=client_credentials&amp;patron=8362432</code></pre>
<p>Response to a rejected login request:</p>
<pre><code>HTTP/1.1 403 Forbidden
Content-Type: application/json; charset=utf-8
X-PAIA-Version: 1.4.0
Cache-Control: no-store
Pragma: no-cache
WWW-Authenticate: Bearer realm=&quot;PAIA auth example&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
  <span class="dt">&quot;error&quot;</span><span class="fu">:</span> <span class="st">&quot;access_denied&quot;</span><span class="fu">,</span>
  <span class="dt">&quot;error_description&quot;</span><span class="fu">:</span> <span class="st">&quot;invalid patron or password&quot;</span>
<span class="fu">}</span></code></pre></div>
</div>
</section>
<section id="logout" class="level2">
<h2><span class="header-section-number">4.2</span> logout</h2>
<dl>
<dt>purpose</dt>
<dd>Invalidate an access token
</dd>
<dt>URL</dt>
<dd>POST https://example.org/auth/<strong>logout</strong> (in addition a PAIA auth server MAY support HTTP GET requests)
</dd>
<dt>request parameters</dt>
<dd><table>
<thead>
<tr class="header">
<th style="text-align: center;">name</th>
<th style="text-align: center;">occ</th>
<th style="text-align: center;">data type</th>
<th style="text-align: center;">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>patron</td>
<td>0..1</td>
<td>string</td>
<td>patron identifier</td>
</tr>
<tr class="even">
<td>token_type_hint</td>
<td>0..1</td>
<td>string</td>
<td>OAuth Token Type Hint</td>
</tr>
</tbody>
</table>
</dd>
<dt>response fields</dt>
<dd><table>
<thead>
<tr class="header">
<th style="text-align: center;">name</th>
<th style="text-align: center;">occ</th>
<th style="text-align: center;">data type</th>
<th style="text-align: center;">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>patron</td>
<td>0..1</td>
<td>string</td>
<td>patron identifier</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<p>The logout method invalidates an access token, independent from the previous lifetime of the token. On success, the server MUST invalidate at least the access token that was used to access this method. The server MAY further invalidate additional access tokens that were created for the same patron.</p>
<p>Note that this method does not fully conform to <a href="https://github.com/gbv/paia/issues/49">RFC 7009 OAuth 2.0 token revocation</a> but provides same functionality.</p>
<div class="example">
<pre><code>POST /auth/logout HTTP/1.1
Host: example.org
User-Agent: MyPAIAClient/1.0
Accept: application/json
Content-Type: application/x-www-form-urlencoded
Authorization: Bearer 2YotnFZFEjr1zCsicMWpAA

patron=8362432

HTTP/1.1 200 OK
Content-Type: application/json; charset=UTF-8
X-PAIA-Version: 1.4.0</code></pre>
<div class="sourceCode"><pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
  <span class="dt">&quot;patron&quot;</span><span class="fu">:</span> <span class="st">&quot;3110372827&quot;</span>
<span class="fu">}</span></code></pre></div>
</div>
</section>
<section id="change" class="level2">
<h2><span class="header-section-number">4.3</span> change</h2>
<dl>
<dt>purpose</dt>
<dd>Change password of a patron
</dd>
<dt>URL</dt>
<dd>POST https://example.org/auth/<strong>change</strong>
</dd>
<dt>scope</dt>
<dd>change_password
</dd>
<dt>request parameters</dt>
<dd><table>
<thead>
<tr class="header">
<th style="text-align: center;">name</th>
<th style="text-align: center;">occ</th>
<th style="text-align: center;">data type</th>
<th style="text-align: center;">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>patron</td>
<td>1..1</td>
<td>string</td>
<td>Patron identifier</td>
</tr>
<tr class="even">
<td>username</td>
<td>1..1</td>
<td>string</td>
<td>User name of the patron</td>
</tr>
<tr class="odd">
<td>old_password</td>
<td>1..1</td>
<td>string</td>
<td>Password of the patron</td>
</tr>
<tr class="even">
<td>new_password</td>
<td>1..1</td>
<td>string</td>
<td>New password of the patron</td>
</tr>
</tbody>
</table>
</dd>
<dt>response fields</dt>
<dd><table>
<thead>
<tr class="header">
<th style="text-align: center;">name</th>
<th style="text-align: center;">occ</th>
<th style="text-align: center;">data type</th>
<th style="text-align: center;">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>patron</td>
<td>1..1</td>
<td>string</td>
<td>patron identifier</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<p>The server MUST check</p>
<ul>
<li>the access token</li>
<li>whether username and password match</li>
<li>whether the user identified by username has scope <code>change_password</code></li>
</ul>
<p>A PAIA server MAY reject this method and return an <a href="#request-errors">error response</a> with error code <code>access_denied</code> (403) or error code <code>not_implemented</code> (501). On success, the patron identifier is returned.</p>
<div class="example">
<p>Successfully change password:</p>
<pre><code>POST /auth/change HTTP/1.1
Host: example.org
User-Agent: MyPAIAClient/1.0
Accept: application/json
Content-Type: application/x-www-form-urlencoded
Authorization: Bearer KrLmpnAjEZv9DK85ULS3K3

patron=8362432&amp;old_password=12345&amp;new_password=BKaa8p90gq3nhkiXX4Fxkqii

HTTP/1.1 200 OK
Content-Type: application/json; charset=UTF-8
X-PAIA-Version: 1.4.0</code></pre>
<div class="sourceCode"><pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
  <span class="dt">&quot;patron&quot;</span><span class="fu">:</span> <span class="st">&quot;836243&quot;</span>
<span class="fu">}</span></code></pre></div>
</div>
</section>
<section id="reset" class="level2">
<h2><span class="header-section-number">4.4</span> reset</h2>
<dl>
<dt>purpose</dt>
<dd>Reset password of a patron
</dd>
<dt>URL</dt>
<dd>POST https://example.org/auth/<strong>reset</strong>
</dd>
<dt>scope</dt>
<dd>reset_password
</dd>
<dt>request parameters</dt>
<dd><table>
<thead>
<tr class="header">
<th style="text-align: center;">name</th>
<th style="text-align: center;">occ</th>
<th style="text-align: center;">data type</th>
<th style="text-align: center;">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>patron</td>
<td>1..1</td>
<td>string</td>
<td>Patron identifier</td>
</tr>
</tbody>
</table>
</dd>
<dt>response fields</dt>
<dd><table>
<thead>
<tr class="header">
<th style="text-align: center;">name</th>
<th style="text-align: center;">occ</th>
<th style="text-align: center;">data type</th>
<th style="text-align: center;">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>patron</td>
<td>1..1</td>
<td>string</td>
<td>patron identifier</td>
</tr>
<tr class="even">
<td>message</td>
<td>0..1</td>
<td>string</td>
<td>optional message</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<p>If supported, this method initiates a password reset by means not defined by this specification (for instance a message is sent to the patron by email). The server SHOULD also create a <a href="#patron-notification">notification</a> when a password has been resetted.</p>
<p>The <a href="#login">login</a> method must be called first to retrieve an access token with scope <code>reset_passord</code> and to validate the patron identifier.</p>
<div class="example">
<pre><code>POST /auth/reset HTTP/1.1
Host: example.org
User-Agent: MyPAIAClient/1.0
Accept: application/json
Accept-Language: en
Content-Type: application/x-www-form-urlencoded
Authorization: Bearer WwLagU19tegibdLWJ9R69s

patron=8362432

HTTP/1.1 200 OK
Content-Type: application/json; charset=UTF-8
X-PAIA-Version: 1.4.0
Content-Language: en</code></pre>
<div class="sourceCode"><pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
  <span class="dt">&quot;patron&quot;</span><span class="fu">:</span> <span class="st">&quot;836243&quot;</span><span class="fu">,</span>
  <span class="dt">&quot;message&quot;</span><span class="fu">:</span> <span class="st">&quot;An email has been sent to you to set a new password&quot;</span>
<span class="fu">}</span></code></pre></div>
</div>
</section>
</section>
<section id="glossary" class="level1">
<h1><span class="header-section-number">5</span> Glossary</h1>
<dl>
<dt>access token</dt>
<dd>A confidential random string that must be sent with each PAIA request for authentication.
</dd>
<dt>document</dt>
<dd>A concrete or abstract document, such as a work, or an edition.
</dd>
<dt>item</dt>
<dd>A concrete copy of a document, for instance a particular physical book.
</dd>
<dt>PAIA auth server</dt>
<dd>HTTP endpoint that implements the PAIA auth specification, so all PAIA auth methods can be accessed at a common base URL.
</dd>
<dt>PAIA core server</dt>
<dd>HTTP endpoint that implements the PAIA core specification, so all PAIA core methods can be accessed at a common base URL.
</dd>
<dt>patron</dt>
<dd>An account of a library user
</dd>
<dt>patron identifier</dt>
<dd>A Unicode string that identifies a library patron account.
</dd>
</dl>
</section>
<section id="security-considerations" class="level1">
<h1><span class="header-section-number">6</span> Security considerations</h1>
<p>Security of OAuth 2.0 with bearer tokens relies on correct application of HTTPS. It is known that SSL certificate errors are often ignored just because of laziness. It MUST be clear to all implementors that this breaks the chain of trust and is as secure as sending access tokens in plain text.</p>
<p>To limit the risk of spoiled access tokens, PAIA servers SHOULD put limits on the lifetime of access tokens and on the number of allowed requests per minute among other security limitations.</p>
<p>It is also known that several library systems allow weak passwords. For this reason PAIA auth servers MUST follow appropriate security measures, such as protecting against brute force attacks and blocking accounts with weak passwords or with passwords that have been sent unencrypted.</p>
</section>
<section id="informative-parts" class="level1">
<h1><span class="header-section-number">7</span> Informative parts</h1>
<p>This non-normative section contains additional examples and explanations to illustrate the semantics of PAIA concepts and methods and usage.</p>
<section id="transitions-of-service-states" class="level2">
<h2><span class="header-section-number">7.1</span> Transitions of service states</h2>
<p>Six service status <a href="#simple-data-types">data type</a> values are possible. One document can have different status for different patrons and for different times. The following table illustrates reasonable transitions of service status with time for a fixed patron. For instance some document held by another patron is first requested (0 → 1) with PAIA method <a href="#request">request</a>, made available after return (1 → 4), picked up (4 → 3), renewed after some time with PAIA method <a href="#renew">renew</a> (3 → 3) and later returned (3 → 0).</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">transition →</th>
<th style="text-align: center;">0</th>
<th style="text-align: center;">1: reserved</th>
<th style="text-align: center;">2: ordered</th>
<th style="text-align: center;">3: held</th>
<th style="text-align: center;">4: provided</th>
<th style="text-align: center;">5: rejected</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>=</td>
<td><code>request</code></td>
<td><code>request</code></td>
<td>loan</td>
<td><code>request</code></td>
<td><code>request</code></td>
</tr>
<tr class="even">
<td>1: reserved</td>
<td><code>cancel</code></td>
<td>=</td>
<td>available</td>
<td>loan</td>
<td>available</td>
<td>patron inactive, document lost …</td>
</tr>
<tr class="odd">
<td>2: ordered</td>
<td><code>cancel</code></td>
<td>/</td>
<td>=</td>
<td>loan</td>
<td>available</td>
<td>patron inactive, document lost …</td>
</tr>
<tr class="even">
<td>3: held</td>
<td>return</td>
<td>/</td>
<td>/</td>
<td><code>renew</code></td>
<td>/</td>
<td>/</td>
</tr>
<tr class="odd">
<td>4: provided</td>
<td>not picked up</td>
<td>/</td>
<td>/</td>
<td>loan</td>
<td>=</td>
<td>patron inactive, …</td>
</tr>
<tr class="even">
<td>5: rejected</td>
<td>time passed</td>
<td>patron active</td>
<td>patron active</td>
<td>/</td>
<td>patron active</td>
<td>=</td>
</tr>
</tbody>
</table>
<p>Transitions marked with “/” may also be possible in special circumstances: for instance a book ordered from the stacks (status 2) may turn out to be damaged, so it is first repaired and reserved for the patron meanwhile (status 1). Transitions for digital publications may also be different. Note that a PAIA server does not need to implement all service status. A reasonable subset is to only support 0, 1, 3, and 5.</p>
</section>
<section id="digital-documents" class="level2">
<h2><span class="header-section-number">7.2</span> Digital documents</h2>
<p>The handling of digital documents is subject to frequently asked questions. The following rules of thumb may help:</p>
<ul>
<li>For most digital documents the concept of an item does not make sense and there is no URI of a particular copy. In this case the <code>document.edition</code> field should be used instead of <code>document.item</code>.</li>
<li>For some digital documents there may be no distinction between status <code>provided</code> and status <code>held</code>. The status <code>provided</code> should be preferred when the same document can be used by multiple patrons at the same time, and <code>held</code> should be used when the document can exclusively be used by the patron.</li>
</ul>
</section>
<section id="paia-core-extensions-to-non-document-services" class="level2">
<h2><span class="header-section-number">7.3</span> PAIA core extensions to non-document services</h2>
<p>A future version of PAIA may be extended to support services not related to documents. For instance a patron may reserve a cabin or some other facility. The following methods may be added to PAIA core for this purpose:</p>
<dl>
<dt>services</dt>
<dd>List non-document services related to a patron - similar to method <a href="#items">items</a>.
</dd>
<dt>servicetypes</dt>
<dd>Get a list of services that a patron may request, each with URI, name, and short description.
</dd>
</dl>
<hr />
</section>
</section>
<section id="references" class="level1">
<h1><span class="header-section-number">8</span> References</h1>
<section id="normative-references" class="level2">
<h2><span class="header-section-number">8.1</span> Normative References</h2>
<ul>
<li><p>Bradner, S. 1997. “RFC 2119: Key words for use in RFCs to Indicate Requirement Levels”. <a href="http://tools.ietf.org/html/rfc2119" class="uri">http://tools.ietf.org/html/rfc2119</a>.</p></li>
<li><p>Crockford, D. 2006. “RFC 6427: The application/json Media Type for JavaScript Object Notation (JSON)”. <a href="http://tools.ietf.org/html/rfc4627" class="uri">http://tools.ietf.org/html/rfc4627</a>.</p></li>
<li><p>Fielding, R. 1999. “RFC 2616: Hypertext Transfer Protocol”. <a href="http://tools.ietf.org/html/rfc2616" class="uri">http://tools.ietf.org/html/rfc2616</a>.</p></li>
<li><p>Franks, J. et al. 1999: “RFC 2617: HTTP Authentication: Basic and Digest Access Authentication”. <a href="http://tools.ietf.org/html/rfc2617" class="uri">http://tools.ietf.org/html/rfc2617</a>.</p></li>
<li><p>D. Hardt. 2012. “RFC 6749: The OAuth 2.0 Authorization Framework”. <a href="http://tools.ietf.org/html/rfc6749" class="uri">http://tools.ietf.org/html/rfc6749</a>.</p></li>
<li><p>Jones, M. and Hardt, D. 2012. “RFC 6750: The OAuth 2.0 Authorization Framework: Bearer Token Usage”. <a href="http://tools.ietf.org/html/rfc6750" class="uri">http://tools.ietf.org/html/rfc6750</a>.</p></li>
<li><p>van Kesteren, Anne. 2014. “Cross-Origin Resource Sharing” <a href="http://www.w3.org/TR/cors/" class="uri">http://www.w3.org/TR/cors/</a></p></li>
<li><p>Rescorla, E. 2000. “RFC 2818: HTTP over TLS.” <a href="http://tools.ietf.org/html/rfc2818" class="uri">http://tools.ietf.org/html/rfc2818</a>.</p></li>
</ul>
</section>
<section id="informative-references" class="level2">
<h2><span class="header-section-number">8.2</span> Informative References</h2>
<ul>
<li><p>3M. 2006. “3M Standard Interchange Protocol Version 2.00“. <a href="http://mws9.3m.com/mws/mediawebserver.dyn?6666660Zjcf6lVs6EVs66S0LeCOrrrrQ-" class="uri">http://mws9.3m.com/mws/mediawebserver.dyn?6666660Zjcf6lVs6EVs66S0LeCOrrrrQ-</a>.</p></li>
<li><p>ILS-DI. 2008. “DLF ILS Discovery Interface Task Group (ILS-DI) Technical Recommendation - revision 1.1“ <a href="http://old.diglib.org/architectures/ilsdi/" class="uri">http://old.diglib.org/architectures/ilsdi/</a>.</p></li>
<li><p>Katz, D. 2013. “ILS Driver (VuFind 2.x)“. <a href="http://vufind.org/wiki/vufind2:building_an_ils_driver" class="uri">http://vufind.org/wiki/vufind2:building_an_ils_driver</a>.</p></li>
<li><p>NISO. 2010. “NISO Circulation Interchange Protocol (NCIP) - Z39.83-1-2008 Version 2.01“. <a href="http://www.ncip.info/" class="uri">http://www.ncip.info/</a>.</p></li>
<li><p>Voß, J. 2015. “PAIA Ontology“. <a href="http://gbv.github.io/paia-rdf/" class="uri">http://gbv.github.io/paia-rdf/</a>.</p></li>
<li><p>Voß, J. 2014. “Document Service Ontology“ <a href="http://purl.org/ontology/dso" class="uri">http://purl.org/ontology/dso</a>.</p></li>
<li><p>“PAIA Wiki“. <a href="https://github.com/gbv/paia/wiki" class="uri">https://github.com/gbv/paia/wiki</a></p></li>
</ul>
</section>
<section id="revision-history" class="level2">
<h2><span class="header-section-number">8.3</span> Revision history</h2>
<p>This is version <strong>1.4.0</strong> of PAIA specification, last modified at 2023-08-24 with revision <a href="http://github.com/gbv/paia/commit/5bd6d139cff9e8bcb121995c14f279aea0c2508c">5bd6d13</a>.</p>
<p>Version numbers follow <a href="http://semver.org/">Semantic Versioning</a>: each number consists of three numbers, optionally followed by <code>+</code> and a suffix:</p>
<ul>
<li>The major version (first number) is increased if changes require a modification of PAIA clients</li>
<li>The minor version (second number) is increased if changes require a modification of PAIA servers</li>
<li>The patch version (third number) is increased for backwards compatible fixes or extensions, such as the introduction of new optional fields</li>
<li>The optional suffix indicates informal changes in documentation</li>
</ul>
<section id="releases" class="level3 unnumbered">
<h3>Releases</h3>
<p>Releases with functional changes are tagged with a version number and included at <a href="https://github.com/gbv/paia/releases" class="uri">https://github.com/gbv/paia/releases</a> with release notes.</p>
<section id="section" class="level4 unnumbered">
<h4>1.4.0 (2023-08-24)</h4>
<ul>
<li>add optional comment field</li>
<li>remove deprecated fields <code>duedate</code> and <code>storageid</code></li>
<li>make <code>patron</code> field of logout method optional</li>
<li>add PAIA auth method to reset passwords</li>
</ul>
</section>
<section id="section-1" class="level4 unnumbered">
<h4>1.3.4 (2018-09-10)</h4>
<ul>
<li>add support of <a href="#patron-notification">notifications</a></li>
</ul>
</section>
<section id="section-2" class="level4 unnumbered">
<h4>1.3.3 (2017-03-29)</h4>
<ul>
<li>add patron field <code>note</code></li>
</ul>
</section>
<section id="section-3" class="level4 unnumbered">
<h4>1.3.2 (2016-12-20)</h4>
<ul>
<li>make response headers Content-Type, X-PAIA-Version, and Access-Control-Allow-Headers (the latter only for OPTIONS requests) mandatory</li>
</ul>
</section>
<section id="section-4" class="level4 unnumbered">
<h4>1.3.1 (2016-12-20)</h4>
<ul>
<li>add PAIA core method to update patron</li>
<li>extend PAIA auth login to optionally support OAuth client credentials grant</li>
<li>extend PAIA auth logout method with token_type_hint and optional response fields</li>
</ul>
</section>
<section id="section-5" class="level4 unnumbered">
<h4>1.3.0 (2015-11-06)</h4>
<ul>
<li>introduce conditions and confirmations</li>
<li>clarify uniqueness of storage/fee/condition id and textual description</li>
<li>remove experimental reference to service ontology</li>
</ul>
</section>
<section id="section-6" class="level4 unnumbered">
<h4>1.2.0 (2015-04-28)</h4>
<ul>
<li>PAIA auth MUST support content type <code>application/x-www-form-urlencoded</code> to align with OAuth 2.0 (issue #50)</li>
</ul>
</section>
<section id="section-7" class="level4 unnumbered">
<h4>1.1.0 (2015-04-21)</h4>
<ul>
<li>add mandatory HTTP OPTIONS and optional HTTP HEAD requests</li>
<li>extend CORS headers (<code>Access-Control-...</code>)</li>
<li>fix name of <code>WWW-Authenticate</code> header</li>
<li>remove request field <code>doc.storage</code> and deprecate field <code>doc.storageid</code></li>
<li>improve documentation</li>
</ul>
</section>
<section id="section-8" class="level4 unnumbered">
<h4>1.0.8 (2015-04-16)</h4>
<ul>
<li>support content-negotiation for languages (issue #32)</li>
<li>allow additional scopes not part of PAIA</li>
<li>split PAIA ontology from PAIA specification</li>
</ul>
</section>
<section id="section-9" class="level4 unnumbered">
<h4>1.0.7 (2015-04-14)</h4>
<ul>
<li>add patron field <code>type</code></li>
</ul>
</section>
<section id="section-10" class="level4 unnumbered">
<h4>1.0.6 (2014-11-10)</h4>
<ul>
<li>add patron field <code>address</code></li>
</ul>
</section>
<section id="section-11" class="level4 unnumbered">
<h4>1.0.5 (2014-07-16)</h4>
<ul>
<li>add CORS HTTP headers</li>
</ul>
</section>
<section id="section-12" class="level4 unnumbered">
<h4>1.0.4 (2014-07-14)</h4>
<ul>
<li>extend definition of datetime fields</li>
</ul>
</section>
<section id="section-13" class="level4 unnumbered">
<h4>1.0.3 (2014-07-11)</h4>
<ul>
<li>add document fields <code>starttime</code> and <code>endtime</code></li>
</ul>
</section>
<section id="section-14" class="level4 unnumbered">
<h4>1.0.1 (2013-11-20)</h4>
<ul>
<li>add <code>User-Agent</code> header</li>
</ul>
</section>
</section>
<section id="full-changelog" class="level3 unnumbered">
<h3>Full changelog</h3>
<ul>
<li><a href="paia-5bd6d13.html"><code>2023-08-24 17:33:56 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/5bd6d139cff9e8bcb121995c14f279aea0c2508c">add PAIA auth method to reset passwords</a></li>
<li><a href="paia-51f1e12.html"><code>2023-08-24 12:46:29 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/51f1e12b171efe9a4d6e53b4d33fa9f0a7367eec">Add example request</a></li>
<li><a href="paia-875e774.html"><code>2023-08-24 12:21:07 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/875e774c826954058cd2f2517e35606cdd47ace5">make patron field of logout method optional (close #49)</a></li>
<li><a href="paia-3136e7e.html"><code>2023-08-24 12:06:07 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/3136e7e993c26181d2d2c3b67b6f6ba0b2a6ff39">Clarify response of cancel method (close #66)</a></li>
<li><a href="paia-2380810.html"><code>2023-08-24 09:16:45 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/23808107c75fa263f2ed01827a62cba1ac6884c7">remove deprecated fields ‘duedate’ and ‘storageid’</a></li>
<li><a href="paia-e3656af.html"><code>2023-08-24 09:11:28 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/e3656af59ad75cd26030085d38be698b6e3dce44">add optional comment field (close #74)</a></li>
<li><a href="paia-3526a31.html"><code>2018-07-09 11:41:35 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/3526a3119a601fcaf4afd8e9781a047f17f690a6">Add support of notifications (#64)</a></li>
<li><a href="paia-2331e66.html"><code>2017-03-29 12:02:06 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/2331e662ab3ef2d37a151e3a03a8aef16e1f1f95">Add patron field ‘note’</a></li>
<li><a href="paia-e90f5e5.html"><code>2016-12-20 11:03:02 +0100</code></a>: <a href="http://github.com/gbv/paia/commit/e90f5e5372caa149f3af41f7f8f9fe6e0f2370e0">Make header Access-Control-Allow-Headers mandatory (#56)</a></li>
<li><a href="paia-ded7f1a.html"><code>2016-12-20 10:44:15 +0100</code></a>: <a href="http://github.com/gbv/paia/commit/ded7f1a07739965b44dbd6743e73f367e5ae1d60">make response headers Content-Type and X-PAIA-Version mandatory (#53)</a></li>
<li><a href="paia-3f2b05f.html"><code>2016-12-05 14:21:27 +0100</code></a>: <a href="http://github.com/gbv/paia/commit/3f2b05f14ca80c302d791b7ad44d114459016339">Extend login with OAuth client credentials grant</a></li>
<li><a href="paia-21ec233.html"><code>2016-12-05 11:57:53 +0100</code></a>: <a href="http://github.com/gbv/paia/commit/21ec23380149295482b51e506afb41e510fedd61">Extend PAIA auth logout to prepare support of RFC 7009 (#49)</a></li>
<li><a href="paia-599ba07.html"><code>2016-12-05 11:23:20 +0100</code></a>: <a href="http://github.com/gbv/paia/commit/599ba07ba80b9cb851100c74fbfbb27c57d68a5e">Add fees example</a></li>
<li><a href="paia-c5e4755.html"><code>2016-12-05 10:39:56 +0100</code></a>: <a href="http://github.com/gbv/paia/commit/c5e4755ce6a286f88fd5c83697bbd70408cdd1ed">Add PAIA core method to update patron (#58)</a></li>
<li><a href="paia-ceb14b3.html"><code>2015-11-16 09:52:47 +0100</code></a>: <a href="http://github.com/gbv/paia/commit/ceb14b3dcc125c81ec6c64b8891a954fd399f0ef">Adjust links and example</a></li>
<li><a href="paia-1b8bf50.html"><code>2015-11-06 09:30:37 +0100</code></a>: <a href="http://github.com/gbv/paia/commit/1b8bf5061246989c0ac184ee043aeabde82ed910">Introduce conditions and confirmations</a></li>
<li><a href="paia-623865b.html"><code>2015-04-28 09:57:09 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/623865b2b60a520e2e284e7c95c568196a12f7ca">PAIA auth requires application/x-www-form-urlencoded (#50)</a></li>
<li><a href="paia-35f2a4e.html"><code>2015-04-21 15:19:10 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/35f2a4e4de414d34de598e66a1fbf44f1dbb3287">document semantic versioning</a></li>
<li><a href="paia-ca90aa7.html"><code>2015-04-21 14:45:40 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/ca90aa737e20058a1091a17fd4b24222004dc91e">remove request field doc.storage, deprecate doc.storageid</a></li>
<li><a href="paia-39f92a1.html"><code>2015-04-21 14:41:52 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/39f92a1f51630a07fc0995a5512dff7e2956fb56">mandatory HTTP OPTIONS for CORS (#46)</a></li>
<li><a href="paia-d70da63.html"><code>2015-04-21 11:09:38 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/d70da6377f83b0e668ec49ce1133d2a13a9b3d54">rearranged section 3</a></li>
<li><a href="paia-1fb333c.html"><code>2015-04-21 10:00:49 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/1fb333c3c0e91554f12b051eeee012e28df72def">updated readme</a></li>
<li><a href="paia-83fbe8c.html"><code>2015-04-21 09:52:47 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/83fbe8c96309718cb215be2d9714fb3ebeb80a89">include list of releases</a></li>
<li><a href="paia-e96c8db.html"><code>2015-04-21 08:50:27 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/e96c8db4df9a31ea2fa22aaa549b8027afe6ebab">moved ‘How to contribute’ to wiki</a></li>
<li><a href="paia-143f118.html"><code>2015-04-16 14:53:42 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/143f118f87bdf7f931d77aee50a6d43efbb06b43">support content-negotiation for languages (issue #32)</a></li>
<li><a href="paia-e527979.html"><code>2015-04-16 14:33:26 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/e5279796a702e5a4225af57157746543fd0c0af1">rearranged section 2</a></li>
<li><a href="paia-be7fe69.html"><code>2015-04-16 13:44:22 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/be7fe69dc5c7702e238b1004d2a77811f038e267">make clear that URLs can be chosen freely (issue #40)</a></li>
<li><a href="paia-4974951.html"><code>2015-04-16 13:34:34 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/49749516567daf541e16161c820e778e707a6a4d">allow additional scopes</a></li>
<li><a href="paia-3e1afd6.html"><code>2015-04-16 09:32:28 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/3e1afd6ba5d2ebe673c1e22896e287e61f68ab07">PAIA ontology as independent specification (issue #21)</a></li>
<li><a href="paia-1760b65.html"><code>2015-04-14 14:57:44 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/1760b650f4071ea5e58aa72ac99c6072783a2b6a">add patron types</a></li>
<li><a href="paia-09afe23.html"><code>2014-11-10 09:45:08 +0100</code></a>: <a href="http://github.com/gbv/paia/commit/09afe23065473e9dd3037ce2649532b708384f8b">include optional patron address field (#29)</a></li>
<li><a href="paia-378492a.html"><code>2014-09-10 10:58:53 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/378492a44c7a9718c50ffc3bb440d655f06cf661">fix JSON example</a></li>
<li><a href="paia-0f2556b.html"><code>2014-07-16 13:24:24 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/0f2556be3ce48c8f62dc4dc62ee8d98fdb17bef8">fixed timezone</a></li>
<li><a href="paia-1892250.html"><code>2014-07-16 12:07:03 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/189225049bb7c77aedb11f9454ef09a47ecfedd0">CORS (issue #37)</a></li>
<li><a href="paia-a1ba047.html"><code>2014-07-16 10:40:02 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/a1ba0476eb85cdf4ace3c19e37aab5e5da0c8967">typo</a></li>
<li><a href="paia-fde96af.html"><code>2014-07-14 09:29:24 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/fde96afb227d532fcb9946285d29e7bf493cc028">fixed datetime</a></li>
<li><a href="paia-df5444d.html"><code>2014-07-11 13:27:03 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/df5444d5c50a7800c30d96e7204d16cfd3454441">include full example (issue #27)</a></li>
<li><a href="paia-0425f2a.html"><code>2014-07-11 11:02:00 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/0425f2a4f0b0a37426ebb0e231d08a342bd9b037">introduce starttime and endtime</a></li>
<li><a href="paia-a31350e.html"><code>2014-07-02 11:54:22 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/a31350e9f042082866a219d8f87bb9f9615cafb0">ontology</a></li>
<li><a href="paia-f7d18b4.html"><code>2014-06-30 16:32:41 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/f7d18b4169181ccb92659589e591ad3596369b96">Clients should send User-Agent header (issue #35)</a></li>
<li><a href="paia-5ac73f0.html"><code>2014-05-16 09:26:25 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/5ac73f0e460e6f83dcaee1f501e5dd22edee95c6">make clear that document errors are not specified</a></li>
<li><a href="paia-96ce9cb.html"><code>2013-11-20 12:57:11 +0100</code></a>: <a href="http://github.com/gbv/paia/commit/96ce9cbb3be5f67c8db51a6ac05ec76de4287f44">example of a document error response</a></li>
<li><a href="paia-06f6338.html"><code>2013-11-18 14:33:19 +0100</code></a>: <a href="http://github.com/gbv/paia/commit/06f633830f6bbceeb81c1c7d167124778a51556e">extended PAIA ontology</a></li>
<li><a href="paia-7f04903.html"><code>2013-10-31 12:32:07 +0100</code></a>: <a href="http://github.com/gbv/paia/commit/7f04903aa3c9d0e859f61a8007ed53bcd8f8bae4">updated makespec</a></li>
<li><a href="paia-a0f7a8b.html"><code>2013-10-31 10:56:44 +0100</code></a>: <a href="http://github.com/gbv/paia/commit/a0f7a8b9903dc429f98ce7dc7e1fe23d5c99f1c2">Corrected logical, grammar, and spelling mistakes</a></li>
<li><a href="paia-3853fb0.html"><code>2013-07-17 09:34:52 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/3853fb06c01fce4a23ea3a716f2ac156707a5007">remove ‘code’ in PAIA auth error response, close #14</a></li>
<li><a href="paia-03ff75a.html"><code>2013-07-17 09:25:57 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/03ff75af0c7eae33daf5e2323149501d19508364">update makespec, closes issue #8 on charset</a></li>
<li><a href="paia-f674725.html"><code>2013-04-16 12:15:42 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/f674725619979632da8beb2e243e6be168fd1931">synopsis, ontology, and informative parts</a></li>
<li><a href="paia-d38607c.html"><code>2013-04-15 09:05:50 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/d38607c9774efe18ea4b8a2fd3fb9442534a8833">note on non-document services (issue #16)</a></li>
<li><a href="paia-b184081.html"><code>2013-04-10 10:47:29 +0200</code></a>: <a href="http://github.com/gbv/paia/commit/b18408116711aa8ac50aa251241d910c0757dfa9">fixes wrong examples, closes #18</a></li>
</ul>
</section>
</section>
</section>
<section class="footnotes">
<hr />
<ol>
<li id="fn1"><p>The Simple Library Network Protocol (SLNP) and its variant XSLNP is an internal protocol of the the SISIS-Sunrise™ library system, providing access to patron information, among other functionality. OCLC does not allow publication of the specification or public use of SLNP.<a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>The error list was compiled from the HTTP and OAuth 2.0 specifications, <a href="https://dev.twitter.com/docs/error-codes-responses">the Twitter API</a>, <a href="https://api.stackexchange.com/docs/error-handling">the StackExchange API</a>, and <a href="http://developer.github.com/v3/#client-errors">the GitHub API</a>.<a href="#fnref2">↩</a></p></li>
</ol>
</section>
</body>
</html>
